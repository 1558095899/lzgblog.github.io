<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>lzg博客</title>
  <icon>https://www.gravatar.com/avatar/d4fd5e38623567de9dcc4593668e09db</icon>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2019-04-12T08:48:52.869Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>lzg blog</name>
    <email>1558095899@qq.com</email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Hexo+Github搭建个人博客</title>
    <link href="http://yoursite.com/2019/04/12/Hexo-Github%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/"/>
    <id>http://yoursite.com/2019/04/12/Hexo-Github搭建个人博客/</id>
    <published>2019-04-12T08:37:03.000Z</published>
    <updated>2019-04-12T08:48:52.869Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Hexo-Github搭建个人博客"><a href="#Hexo-Github搭建个人博客" class="headerlink" title="Hexo+Github搭建个人博客"></a>Hexo+Github搭建个人博客<a id="more"></a></h2><h2 id="1-官网下载node-js。-https-nodejs-org-en"><a href="#1-官网下载node-js。-https-nodejs-org-en" class="headerlink" title="1.   官网下载node.js。 https://nodejs.org/en/"></a>1.   官网下载node.js。 <a href="https://nodejs.org/en/" target="_blank" rel="noopener">https://nodejs.org/en/</a></h2><p><img src="/2019/04/12/Hexo-Github搭建个人博客/1.png" alt="img"></p><h2 id="2-创建blog文件夹-并在此安装node-js-next即可"><a href="#2-创建blog文件夹-并在此安装node-js-next即可" class="headerlink" title="2.   创建blog文件夹  并在此安装node.js  next即可"></a>2.   创建blog文件夹  并在此安装node.js  next即可</h2><h2 id="3-cmd命令cd到node-js的安装的目录，开始安装taobao的镜像源，执行命令：npm-install-g-cnpm-–registry-https-registry-npm-taobao-org"><a href="#3-cmd命令cd到node-js的安装的目录，开始安装taobao的镜像源，执行命令：npm-install-g-cnpm-–registry-https-registry-npm-taobao-org" class="headerlink" title="3.cmd命令cd到node.js的安装的目录，开始安装taobao的镜像源，执行命令：npm install -g cnpm –registry=https://registry.npm.taobao.org"></a>3.cmd命令cd到node.js的安装的目录，开始安装taobao的镜像源，执行命令：npm install -g cnpm –registry=<a href="https://registry.npm.taobao.org" target="_blank" rel="noopener">https://registry.npm.taobao.org</a></h2><p><img src="/2019/04/12/Hexo-Github搭建个人博客/3.png" alt="img"></p><h2 id="4-开始安装hexo，执行命令：cnpm-install-g-hexo-cli"><a href="#4-开始安装hexo，执行命令：cnpm-install-g-hexo-cli" class="headerlink" title="4.开始安装hexo，执行命令：cnpm install -g hexo-cli"></a>4.开始安装hexo，执行命令：cnpm install -g hexo-cli</h2><p><img src="/2019/04/12/Hexo-Github搭建个人博客/4.png" alt="img"></p><h2 id="5-（以下操作都是在git-bash中操作）初始化hexo，创建一个blog文件夹，cd到blog，执行hexo-init，出现start-blogging即可。"><a href="#5-（以下操作都是在git-bash中操作）初始化hexo，创建一个blog文件夹，cd到blog，执行hexo-init，出现start-blogging即可。" class="headerlink" title="5.（以下操作都是在git bash中操作）初始化hexo，创建一个blog文件夹，cd到blog，执行hexo init，出现start blogging即可。"></a>5.（以下操作都是在git bash中操作）初始化hexo，创建一个blog文件夹，cd到blog，执行hexo init，出现start blogging即可。</h2><p><img src="/2019/04/12/Hexo-Github搭建个人博客/5.png" alt="img"></p><h2 id="6-启动hexo，windows10使用命令hexo-server-命令"><a href="#6-启动hexo，windows10使用命令hexo-server-命令" class="headerlink" title="6.启动hexo，windows10使用命令hexo server 命令"></a>6.启动hexo，windows10使用命令hexo server 命令</h2><p><img src="/2019/04/12/Hexo-Github搭建个人博客/6.png" alt="img"></p><h2 id="7-在当前的blog目录下安装一个git插件，使用命令：cnpm-install-–save-hexo-deployer-git"><a href="#7-在当前的blog目录下安装一个git插件，使用命令：cnpm-install-–save-hexo-deployer-git" class="headerlink" title="7.在当前的blog目录下安装一个git插件，使用命令：cnpm install –save hexo-deployer-git"></a>7.在当前的blog目录下安装一个git插件，使用命令：cnpm install –save hexo-deployer-git</h2><p><img src="/2019/04/12/Hexo-Github搭建个人博客/7.png" alt="img"></p><h2 id="8-修改blog目录下的-config-yml配置文件，修改deploy属性，如图。（注意：创建github仓库时命名规范：用户名-github-io）"><a href="#8-修改blog目录下的-config-yml配置文件，修改deploy属性，如图。（注意：创建github仓库时命名规范：用户名-github-io）" class="headerlink" title="8.修改blog目录下的_config.yml配置文件，修改deploy属性，如图。（注意：创建github仓库时命名规范：用户名.github.io）"></a>8.修改blog目录下的_config.yml配置文件，修改deploy属性，如图。（注意：创建github仓库时命名规范：用户名.github.io）</h2><p><img src="/2019/04/12/Hexo-Github搭建个人博客/8.png" alt="img"></p><h2 id="9-可以使用hexo-d将博客部署到远端，依次使用命令："><a href="#9-可以使用hexo-d将博客部署到远端，依次使用命令：" class="headerlink" title="9.可以使用hexo d将博客部署到远端，依次使用命令："></a>9.可以使用hexo d将博客部署到远端，依次使用命令：</h2><h2 id="hexo-clean-hexo-g-hexo-d-，之后提示输入用户名和密码即可。访问地址为：https-lzgblog-github-io"><a href="#hexo-clean-hexo-g-hexo-d-，之后提示输入用户名和密码即可。访问地址为：https-lzgblog-github-io" class="headerlink" title="hexo clean    hexo g     hexo d  ，之后提示输入用户名和密码即可。访问地址为：https://lzgblog.github.io/"></a>hexo clean    hexo g     hexo d  ，之后提示输入用户名和密码即可。访问地址为：<a href="https://lzgblog.github.io/" target="_blank" rel="noopener">https://lzgblog.github.io/</a></h2><p><img src="/2019/04/12/Hexo-Github搭建个人博客/9.png" alt="img"></p><p><img src="/2019/04/12/Hexo-Github搭建个人博客/9.1.png" alt="img"></p><h2 id="10-更换hexo博客主题，访问https-github-com-litten-hexo-theme-yilia找主题。然后"><a href="#10-更换hexo博客主题，访问https-github-com-litten-hexo-theme-yilia找主题。然后" class="headerlink" title="10.更换hexo博客主题，访问https://github.com/litten/hexo-theme-yilia找主题。然后"></a>10.更换hexo博客主题，访问<a href="https://github.com/litten/hexo-theme-yilia" target="_blank" rel="noopener">https://github.com/litten/hexo-theme-yilia</a>找主题。然后</h2><h2 id="git-clone-https-github-com-litten-hexo-theme-yilia-git-themes-yilia，将主题clone到blog-themes-yilia"><a href="#git-clone-https-github-com-litten-hexo-theme-yilia-git-themes-yilia，将主题clone到blog-themes-yilia" class="headerlink" title="git clone https://github.com/litten/hexo-theme-yilia**.git**  themes/yilia，将主题clone到blog\themes\yilia"></a>git clone <a href="https://github.com/litten/hexo-theme-yilia.git" target="_blank" rel="noopener"><strong>https://github.com/litten/hexo-theme-yilia**</strong>.git**</a>  themes/yilia，将主题clone到blog\themes\yilia</h2><p><img src="/2019/04/12/Hexo-Github搭建个人博客/10.png" alt="img"></p><h2 id="11-将主题配到个人博客中，修改blog目录下的-config-yml配置文件中的theme"><a href="#11-将主题配到个人博客中，修改blog目录下的-config-yml配置文件中的theme" class="headerlink" title="11.将主题配到个人博客中，修改blog目录下的_config.yml配置文件中的theme"></a>11.将主题配到个人博客中，修改blog目录下的_config.yml配置文件中的theme</h2><p><img src="/2019/04/12/Hexo-Github搭建个人博客/11.png" alt="img"></p><h2 id="12-然后依次执行命令"><a href="#12-然后依次执行命令" class="headerlink" title="12. 然后依次执行命令"></a>12. 然后依次执行命令</h2><h2 id="Hexo-clean-Hexo-g-Hexo-server-访问localhost：4000查看预览"><a href="#Hexo-clean-Hexo-g-Hexo-server-访问localhost：4000查看预览" class="headerlink" title="Hexo clean  Hexo g   Hexo server  访问localhost：4000查看预览"></a>Hexo clean  Hexo g   Hexo server  访问localhost：4000查看预览</h2><p><img src="/2019/04/12/Hexo-Github搭建个人博客/12.png" alt="img"></p><h2 id="13-每次修改都需要将本地配置推到github远端上保存，使用命令hexo-d，之后访问https-lzgblog-github-io"><a href="#13-每次修改都需要将本地配置推到github远端上保存，使用命令hexo-d，之后访问https-lzgblog-github-io" class="headerlink" title="13.每次修改都需要将本地配置推到github远端上保存，使用命令hexo d，之后访问https://lzgblog.github.io/"></a>13.每次修改都需要将本地配置推到github远端上保存，使用命令hexo d，之后访问<a href="https://lzgblog.github.io/" target="_blank" rel="noopener">https://lzgblog.github.io/</a></h2><p>Hexo博客&lt;next主题&gt;页面基本页面配置参考：</p><p><a href="https://blog.csdn.net/qq_35117024/article/details/81390780" target="_blank" rel="noopener">https://blog.csdn.net/qq_35117024/article/details/81390780</a></p><p><a href="https://blog.csdn.net/Com_ma/article/details/76039859" target="_blank" rel="noopener">https://blog.csdn.net/Com_ma/article/details/76039859</a></p><p><a href="http://www.cnblogs.com/dashucoding/p/10308209.html" target="_blank" rel="noopener">http://www.cnblogs.com/dashucoding/p/10308209.html</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Hexo-Github搭建个人博客&quot;&gt;&lt;a href=&quot;#Hexo-Github搭建个人博客&quot; class=&quot;headerlink&quot; title=&quot;Hexo+Github搭建个人博客&quot;&gt;&lt;/a&gt;Hexo+Github搭建个人博客&lt;/h2&gt;
    
    </summary>
    
    
      <category term="hexo" scheme="http://yoursite.com/tags/hexo/"/>
    
      <category term="github" scheme="http://yoursite.com/tags/github/"/>
    
  </entry>
  
  <entry>
    <title>git本地仓库同步到github</title>
    <link href="http://yoursite.com/2019/04/12/git%E6%9C%AC%E5%9C%B0%E4%BB%93%E5%BA%93%E5%90%8C%E6%AD%A5%E5%88%B0github/"/>
    <id>http://yoursite.com/2019/04/12/git本地仓库同步到github/</id>
    <published>2019-04-12T08:20:54.000Z</published>
    <updated>2019-04-12T08:34:46.706Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1、Github仓库上什么也没有的情况下上传"><a href="#1、Github仓库上什么也没有的情况下上传" class="headerlink" title="1、Github仓库上什么也没有的情况下上传"></a>1、Github仓库上什么也没有的情况下上传<a id="more"></a></h2><h3 id="1）首先github上创建一个仓库"><a href="#1）首先github上创建一个仓库" class="headerlink" title="1）首先github上创建一个仓库"></a>1）首先github上创建一个仓库</h3><p><img src="/2019/04/12/git本地仓库同步到github/1.png" alt></p><h3 id="2）本地创建一个空文件夹并在当前文件夹打开git命令窗口"><a href="#2）本地创建一个空文件夹并在当前文件夹打开git命令窗口" class="headerlink" title="2）本地创建一个空文件夹并在当前文件夹打开git命令窗口"></a>2）本地创建一个空文件夹并在当前文件夹打开git命令窗口</h3><p><img src="/2019/04/12/git本地仓库同步到github/2.png" alt></p><h3 id="3）git关联用户，基本信息的设置（即主要对哪个github用户进行操作）"><a href="#3）git关联用户，基本信息的设置（即主要对哪个github用户进行操作）" class="headerlink" title="3）git关联用户，基本信息的设置（即主要对哪个github用户进行操作）"></a>3）git关联用户，基本信息的设置（即主要对哪个github用户进行操作）</h3><p>设置用户名：git  config  –global  user.name  ‘用户名’</p><p><img src="/2019/04/12/git本地仓库同步到github/3.png" alt></p><p>设置邮箱：git  config  –global  user.email  ‘邮箱’</p><h3 id="4）git命令窗口依次执行以下命令"><a href="#4）git命令窗口依次执行以下命令" class="headerlink" title="4）git命令窗口依次执行以下命令"></a>4）git命令窗口依次执行以下命令</h3><p><img src="/2019/04/12/git本地仓库同步到github/4.png" alt></p><p><img src="/2019/04/12/git本地仓库同步到github/4.1.png" alt></p><h3 id="5-更新github上的页面即可获得上传的文件"><a href="#5-更新github上的页面即可获得上传的文件" class="headerlink" title="5)更新github上的页面即可获得上传的文件"></a>5)更新github上的页面即可获得上传的文件</h3><p><img src="/2019/04/12/git本地仓库同步到github/5.png" alt></p><h2 id="2、当Github上有仓库并存在文件，需要我们自行下载，更改后上传的情况"><a href="#2、当Github上有仓库并存在文件，需要我们自行下载，更改后上传的情况" class="headerlink" title="2、当Github上有仓库并存在文件，需要我们自行下载，更改后上传的情况"></a>2、当Github上有仓库并存在文件，需要我们自行下载，更改后上传的情况</h2><h3 id="1）首先复制github上对应仓库的连接（看清是https的）"><a href="#1）首先复制github上对应仓库的连接（看清是https的）" class="headerlink" title="1）首先复制github上对应仓库的连接（看清是https的）"></a>1）首先复制github上对应仓库的连接（看清是https的）</h3><p><img src="/2019/04/12/git本地仓库同步到github/6.png" alt></p><h3 id="2）在某位置上打开git命令窗口执行命令git-clone-https地址"><a href="#2）在某位置上打开git命令窗口执行命令git-clone-https地址" class="headerlink" title="2）在某位置上打开git命令窗口执行命令git  clone https地址"></a>2）在某位置上打开git命令窗口执行命令git  clone https地址</h3><p><img src="/2019/04/12/git本地仓库同步到github/7.png" alt></p><h3 id="3）创建文件并上传到github的test（下载文件的仓库）仓库中"><a href="#3）创建文件并上传到github的test（下载文件的仓库）仓库中" class="headerlink" title="3）创建文件并上传到github的test（下载文件的仓库）仓库中"></a>3）创建文件并上传到github的test（下载文件的仓库）仓库中</h3><p><img src="/2019/04/12/git本地仓库同步到github/8.png" alt></p><h3 id="4-刷新github页面即可"><a href="#4-刷新github页面即可" class="headerlink" title="4)刷新github页面即可"></a>4)刷新github页面即可</h3><p><img src="/2019/04/12/git本地仓库同步到github/9.png" alt></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;1、Github仓库上什么也没有的情况下上传&quot;&gt;&lt;a href=&quot;#1、Github仓库上什么也没有的情况下上传&quot; class=&quot;headerlink&quot; title=&quot;1、Github仓库上什么也没有的情况下上传&quot;&gt;&lt;/a&gt;1、Github仓库上什么也没有的情况下上传&lt;/h2&gt;
    
    </summary>
    
    
      <category term="github" scheme="http://yoursite.com/tags/github/"/>
    
      <category term="git" scheme="http://yoursite.com/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>关于配置springboot国际化问题</title>
    <link href="http://yoursite.com/2019/04/12/%E5%85%B3%E4%BA%8E%E9%85%8D%E7%BD%AEspringboot%E5%9B%BD%E9%99%85%E5%8C%96%E9%97%AE%E9%A2%98/"/>
    <id>http://yoursite.com/2019/04/12/关于配置springboot国际化问题/</id>
    <published>2019-04-12T08:08:01.000Z</published>
    <updated>2019-04-12T08:16:42.600Z</updated>
    
    <content type="html"><![CDATA[<h3 id="使用springboot版本为1-5-9出现的问题："><a href="#使用springboot版本为1-5-9出现的问题：" class="headerlink" title="使用springboot版本为1.5.9出现的问题："></a>使用springboot版本为1.5.9出现的问题<a id="more"></a>：</h3><h2 id="1-国际化属性配置"><a href="#1-国际化属性配置" class="headerlink" title="1.国际化属性配置"></a>1.国际化属性配置</h2><p><img src="/2019/04/12/关于配置springboot国际化问题/1.png" alt="img"></p><h2 id="2-application-properties配置文件"><a href="#2-application-properties配置文件" class="headerlink" title="2.application.properties配置文件"></a>2.application.properties配置文件</h2><blockquote><p>#配置国际化基础名  login</p></blockquote><blockquote><p>spring.messages.basename=i18n.login</p></blockquote><h2 id="3-页面"><a href="#3-页面" class="headerlink" title="3.页面"></a>3.页面</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;h1 class=&quot;h3 mb-3 font-weight-normal&quot; th:text=&quot;#&#123;login.top&#125;&quot;&gt;Please sign in&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line"> &lt;label class=&quot;sr-only&quot; th:text=&quot;#&#123;login.username&#125;&quot;&gt;Username&lt;/label&gt;</span><br><span class="line"></span><br><span class="line"> &lt;input type=&quot;text&quot; class=&quot;form-control&quot; placeholder=&quot;Username&quot; th:placeholder=&quot;#&#123;login.username&#125;&quot; required=&quot;&quot; autofocus=&quot;&quot;&gt;</span><br><span class="line"></span><br><span class="line"> &lt;label class=&quot;sr-only&quot; th:text=&quot;#&#123;login.password&#125;&quot;&gt;Password&lt;/label&gt;</span><br><span class="line"></span><br><span class="line"> &lt;input type=&quot;password&quot; class=&quot;form-control&quot; placeholder=&quot;Password&quot; th:placeholder=&quot;#&#123;login.password&#125;&quot; required=&quot;&quot;&gt;</span><br><span class="line"></span><br><span class="line"> &lt;div class=&quot;checkbox mb-3&quot;&gt;</span><br><span class="line"></span><br><span class="line">       &lt;label&gt;</span><br><span class="line"></span><br><span class="line">        &lt;input type=&quot;checkbox&quot; value=&quot;remember-me&quot; &gt;[[#&#123;login.remember&#125;]]</span><br></pre></td></tr></table></figure><h2 id="4-浏览器显示"><a href="#4-浏览器显示" class="headerlink" title="4.浏览器显示"></a>4.浏览器显示</h2><p><img src="/2019/04/12/关于配置springboot国际化问题/2.png" alt="img"></p><p>由于basename在1.5.9版本中似乎无法识别“.”,需要把application.properties’文件改成</p><blockquote><p>spring.messages.basename=i18n/login</p></blockquote><p>显示：</p><p><img src="/2019/04/12/关于配置springboot国际化问题/3.png" alt="img"></p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;使用springboot版本为1-5-9出现的问题：&quot;&gt;&lt;a href=&quot;#使用springboot版本为1-5-9出现的问题：&quot; class=&quot;headerlink&quot; title=&quot;使用springboot版本为1.5.9出现的问题：&quot;&gt;&lt;/a&gt;使用springboot版本为1.5.9出现的问题&lt;/h3&gt;
    
    </summary>
    
    
      <category term="springboot" scheme="http://yoursite.com/tags/springboot/"/>
    
      <category term="国际化" scheme="http://yoursite.com/tags/%E5%9B%BD%E9%99%85%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>springboot 热部署和监管(十二)</title>
    <link href="http://yoursite.com/2019/04/12/springboot-%E7%83%AD%E9%83%A8%E7%BD%B2%E5%92%8C%E7%9B%91%E7%AE%A1/"/>
    <id>http://yoursite.com/2019/04/12/springboot-热部署和监管/</id>
    <published>2019-04-12T07:52:28.000Z</published>
    <updated>2019-04-12T07:59:33.916Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-使用springboot的热部署，需要引入devtools依赖，之后不管是修改代码还是html页面都只需要ctrl-F9-重新buid一下就可以直接生效"><a href="#1-使用springboot的热部署，需要引入devtools依赖，之后不管是修改代码还是html页面都只需要ctrl-F9-重新buid一下就可以直接生效" class="headerlink" title="1.使用springboot的热部署，需要引入devtools依赖，之后不管是修改代码还是html页面都只需要ctrl+F9 重新buid一下就可以直接生效"></a>1.使用springboot的热部署，需要引入devtools依赖<a id="more"></a>，之后不管是修改代码还是html页面都只需要<strong>ctrl+F9</strong> 重新buid一下就可以直接生效</h2> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line"></span><br><span class="line">       &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line"></span><br><span class="line">       &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;</span><br><span class="line"></span><br><span class="line">       &lt;optional&gt;true&lt;/optional&gt;</span><br><span class="line"></span><br><span class="line"> &lt;/dependency&gt;</span><br></pre></td></tr></table></figure><p>或者在创建springboot项目时选中core中的<strong>Devtools</strong></p><p><img src="/2019/04/12/springboot-热部署和监管/1.jpg" alt="img"></p><h2 id="2-springboot对生产环境下的监控管理，创建actoator项目进行监控，需要引入spring-boot-starter-actuator。"><a href="#2-springboot对生产环境下的监控管理，创建actoator项目进行监控，需要引入spring-boot-starter-actuator。" class="headerlink" title="2.springboot对生产环境下的监控管理，创建actoator项目进行监控，需要引入spring-boot-starter-actuator。"></a>2.springboot对生产环境下的监控管理，创建actoator项目进行监控，需要引入<strong>spring-boot-starter-actuator</strong>。</h2><p><img src="/2019/04/12/springboot-热部署和监管/2.jpg" alt="img"></p><h2 id="3-监控访问的地址和相关监控的端点描述，访问地址为：http-localhost-8080-beans-这个是端点名-，访问监控需要把springboot的安全管理关闭，即配置文件中配置-management-security-enabled-false"><a href="#3-监控访问的地址和相关监控的端点描述，访问地址为：http-localhost-8080-beans-这个是端点名-，访问监控需要把springboot的安全管理关闭，即配置文件中配置-management-security-enabled-false" class="headerlink" title="3.监控访问的地址和相关监控的端点描述，访问地址为：http://localhost:8080/beans   (这个是端点名)，访问监控需要把springboot的安全管理关闭，即配置文件中配置  management.security.enabled=false"></a>3.监控访问的地址和相关监控的端点描述，访问地址为：<a href="http://localhost:8080/beans" target="_blank" rel="noopener">http://localhost:8080/beans</a>   (这个是端点名)，访问监控需要把<strong>springboot的安全管理关闭</strong>，即配置文件中配置  <strong>management.security.enabled=false</strong></h2><h2 id="相关监控和管理端点以及对应的描述"><a href="#相关监控和管理端点以及对应的描述" class="headerlink" title="相关监控和管理端点以及对应的描述"></a>相关监控和管理端点以及对应的描述</h2><p><img src="/2019/04/12/springboot-热部署和监管/3.jpg" alt="img"></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;1-使用springboot的热部署，需要引入devtools依赖，之后不管是修改代码还是html页面都只需要ctrl-F9-重新buid一下就可以直接生效&quot;&gt;&lt;a href=&quot;#1-使用springboot的热部署，需要引入devtools依赖，之后不管是修改代码还是html页面都只需要ctrl-F9-重新buid一下就可以直接生效&quot; class=&quot;headerlink&quot; title=&quot;1.使用springboot的热部署，需要引入devtools依赖，之后不管是修改代码还是html页面都只需要ctrl+F9 重新buid一下就可以直接生效&quot;&gt;&lt;/a&gt;1.使用springboot的热部署，需要引入devtools依赖&lt;/h2&gt;
    
    </summary>
    
    
      <category term="springboot" scheme="http://yoursite.com/tags/springboot/"/>
    
      <category term="devtools" scheme="http://yoursite.com/tags/devtools/"/>
    
      <category term="actuator" scheme="http://yoursite.com/tags/actuator/"/>
    
  </entry>
  
  <entry>
    <title>springboot-zookeeper-dubbo 分布式(十一)</title>
    <link href="http://yoursite.com/2019/04/12/springboot-zookeeper-dubbo/"/>
    <id>http://yoursite.com/2019/04/12/springboot-zookeeper-dubbo/</id>
    <published>2019-04-12T07:43:51.000Z</published>
    <updated>2019-04-12T07:51:23.994Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-使用Zookeeper-Dubbo的方式开发分布式系统。"><a href="#1-使用Zookeeper-Dubbo的方式开发分布式系统。" class="headerlink" title="1.使用Zookeeper+Dubbo的方式开发分布式系统。"></a>1.使用Zookeeper+Dubbo的方式开发分布式系统。<a id="more"></a></h2><p>下载安装Zookeeper，地址：<a href="http://archive.apache.org/dist/zookeeper/" target="_blank" rel="noopener">http://archive.apache.org/dist/zookeeper/</a>    。解压之后修改</p><p>D:\Zookeeper\zookeeper-3.4.9\conf目录下的<strong>zoo_sample.cfg</strong>文件名为<strong>zoo.cfg</strong>  并修改其中的内容：</p><p><img src="/2019/04/12/springboot-zookeeper-dubbo/1.jpg" alt="img"></p><p>之后双击bin目录下的<strong>zkServer.cmd</strong>启动服务，出现<strong>2181</strong>即可。或者使用cmd命令执行jps查看是否启动。</p><p><img src="/2019/04/12/springboot-zookeeper-dubbo/2.jpg" alt="img"></p><h2 id="2-springboot需要引入zkclient和dubbo依赖"><a href="#2-springboot需要引入zkclient和dubbo依赖" class="headerlink" title="2.springboot需要引入zkclient和dubbo依赖"></a>2.springboot需要引入zkclient和dubbo依赖</h2> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--引入dubbo依赖--&gt;</span><br><span class="line"></span><br><span class="line"> &lt;dependency&gt;</span><br><span class="line"></span><br><span class="line">     &lt;groupId&gt;com.alibaba.boot&lt;/groupId&gt;</span><br><span class="line"></span><br><span class="line">     &lt;artifactId&gt;dubbo-spring-boot-starter&lt;/artifactId&gt;</span><br><span class="line"></span><br><span class="line">     &lt;version&gt;0.1.0&lt;/version&gt;</span><br><span class="line"></span><br><span class="line"> &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line"> &lt;!--引入zookeeper的客户端工具--&gt;</span><br><span class="line"></span><br><span class="line"> &lt;!-- https://mvnrepository.com/artifact/com.github.sgroschupf/zkclient --&gt;</span><br><span class="line"></span><br><span class="line"> &lt;dependency&gt;</span><br><span class="line"></span><br><span class="line">     &lt;groupId&gt;com.github.sgroschupf&lt;/groupId&gt;</span><br><span class="line"></span><br><span class="line">     &lt;artifactId&gt;zkclient&lt;/artifactId&gt;</span><br><span class="line"></span><br><span class="line">     &lt;version&gt;0.1&lt;/version&gt;</span><br><span class="line"></span><br><span class="line"> &lt;/dependency&gt;</span><br></pre></td></tr></table></figure><h2 id="3-在配置文件中配置Dubbo的项目名称name、发布注册的地址address和发布服务的类所在的包base-package"><a href="#3-在配置文件中配置Dubbo的项目名称name、发布注册的地址address和发布服务的类所在的包base-package" class="headerlink" title="3.在配置文件中配置Dubbo的项目名称name、发布注册的地址address和发布服务的类所在的包base-package"></a>3.在配置文件中配置Dubbo的项目名称name、发布注册的地址address和发布服务的类所在的包base-package</h2><blockquote><p>#配置dubbo的name  name为当前项目的名称<br>dubbo.application.name=springboot-server<br>#配置发布服务的地址  即zookeeper的默认端口为2181<br>dubbo.registry.address=zookeeper://127.0.0.1:2181<br>#配置dubbo的扫描包   扫描dubbo发布服务的包<br>dubbo.scan.base-packages=com.springboot.service </p></blockquote><h2 id="4-使用dubbo包下的-Service注解在实现类上发布服务-需要写service服务的接口和实现类-client只需要拿到接口即可调用方法"><a href="#4-使用dubbo包下的-Service注解在实现类上发布服务-需要写service服务的接口和实现类-client只需要拿到接口即可调用方法" class="headerlink" title="4.使用dubbo包下的@Service注解在实现类上发布服务  需要写service服务的接口和实现类   client只需要拿到接口即可调用方法"></a>4.使用dubbo包下的@Service注解在实现类上发布服务  需要写service服务的接口和实现类   client只需要拿到接口即可调用方法</h2><h2 id="5-引用服务的client项目同也需要引入依赖和配置name、address（即可）。并需要把发布服务的接口即-包名-接口-复制过来-保证该接口（MyService接口）的全限定名称一样-即包名-接口一样"><a href="#5-引用服务的client项目同也需要引入依赖和配置name、address（即可）。并需要把发布服务的接口即-包名-接口-复制过来-保证该接口（MyService接口）的全限定名称一样-即包名-接口一样" class="headerlink" title="5.引用服务的client项目同也需要引入依赖和配置name、address（即可）。并需要把发布服务的接口即 包名+接口 复制过来  保证该接口（MyService接口）的全限定名称一样 即包名+接口一样"></a>5.引用服务的client项目同也需要引入依赖和配置name、address（即可）。并需要把发布服务的接口即 包名+接口 复制过来  保证该接口（MyService接口）的全限定名称一样 即包名+接口一样</h2><blockquote><p> #调用端只需要配置配置文件中dubbo的name和address<br> #配置client端 dubbo的name<br> dubbo.application.name=springboot-client<br> #配置需要引用的服务<br> dubbo.registry.address=zookeeper://127.0.0.1:2181</p></blockquote><h2 id="6-在注入的接口上使用-Reference（alibaba包下）注解远程使用发布的服务，即可"><a href="#6-在注入的接口上使用-Reference（alibaba包下）注解远程使用发布的服务，即可" class="headerlink" title="6.在注入的接口上使用@Reference（alibaba包下）注解远程使用发布的服务，即可"></a>6.在注入的接口上使用@Reference（alibaba包下）注解远程使用发布的服务，即可</h2>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;1-使用Zookeeper-Dubbo的方式开发分布式系统。&quot;&gt;&lt;a href=&quot;#1-使用Zookeeper-Dubbo的方式开发分布式系统。&quot; class=&quot;headerlink&quot; title=&quot;1.使用Zookeeper+Dubbo的方式开发分布式系统。&quot;&gt;&lt;/a&gt;1.使用Zookeeper+Dubbo的方式开发分布式系统。&lt;/h2&gt;
    
    </summary>
    
    
      <category term="springboot" scheme="http://yoursite.com/tags/springboot/"/>
    
      <category term="zookeeper" scheme="http://yoursite.com/tags/zookeeper/"/>
    
      <category term="dubbo" scheme="http://yoursite.com/tags/dubbo/"/>
    
  </entry>
  
  <entry>
    <title>springboot-security 安全(十)</title>
    <link href="http://yoursite.com/2019/04/12/springboot-security/"/>
    <id>http://yoursite.com/2019/04/12/springboot-security/</id>
    <published>2019-04-12T07:35:17.000Z</published>
    <updated>2019-04-12T07:41:57.195Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-spring-security是springboot底层默认使用的安全模块，主要通过WebSecurityConfigurerAdapter类中的configure来进行授权（Authorization）和认证（Authentication），实现安全。"><a href="#1-spring-security是springboot底层默认使用的安全模块，主要通过WebSecurityConfigurerAdapter类中的configure来进行授权（Authorization）和认证（Authentication），实现安全。" class="headerlink" title="1.spring security是springboot底层默认使用的安全模块，主要通过WebSecurityConfigurerAdapter类中的configure来进行授权（Authorization）和认证（Authentication），实现安全。"></a>1.spring security是springboot底层默认使用的安全模块<a id="more"></a>，主要通过WebSecurityConfigurerAdapter类中的configure来进行授权（Authorization）和认证（Authentication），实现安全。</h2><h2 id="2-首先需要引入security依赖，使用html动态获取数据需要引入thymeleaf模板依赖，还有thymeleaf和security整合的依赖，版本等。"><a href="#2-首先需要引入security依赖，使用html动态获取数据需要引入thymeleaf模板依赖，还有thymeleaf和security整合的依赖，版本等。" class="headerlink" title="2.首先需要引入security依赖，使用html动态获取数据需要引入thymeleaf模板依赖，还有thymeleaf和security整合的依赖，版本等。"></a>2.首先需要引入security依赖，使用html动态获取数据需要引入thymeleaf模板依赖，还有thymeleaf和security整合的依赖，版本等。</h2><p>所使用的依赖：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--引入thymeleaf依赖--&gt;</span><br><span class="line"></span><br><span class="line"> &lt;dependency&gt;</span><br><span class="line"></span><br><span class="line">     &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line"></span><br><span class="line">     &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;</span><br><span class="line"></span><br><span class="line"> &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line"> &lt;!--引入security依赖--&gt;</span><br><span class="line"></span><br><span class="line"> &lt;dependency&gt;</span><br><span class="line"></span><br><span class="line">     &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line"></span><br><span class="line">     &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;</span><br><span class="line"></span><br><span class="line"> &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line"> &lt;!--引入thymeleaf和security整合的依赖--&gt;</span><br><span class="line"></span><br><span class="line"> &lt;dependency&gt;</span><br><span class="line"></span><br><span class="line">     &lt;groupId&gt;org.thymeleaf.extras&lt;/groupId&gt;</span><br><span class="line"></span><br><span class="line">     &lt;artifactId&gt;thymeleaf-extras-springsecurity4&lt;/artifactId&gt;</span><br><span class="line"></span><br><span class="line"> &lt;/dependency&gt;</span><br></pre></td></tr></table></figure><p>版本属性：</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;properties&gt;</span><br><span class="line"></span><br><span class="line">    &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;</span><br><span class="line"></span><br><span class="line">    &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;</span><br><span class="line"></span><br><span class="line">    &lt;java.version&gt;1.8&lt;/java.version&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!--配置thymeleaf、layout、thymeleaf-security的版本--&gt;</span><br><span class="line"></span><br><span class="line">    &lt;thymeleaf.version&gt;3.0.9.RELEASE&lt;/thymeleaf.version&gt;</span><br><span class="line"></span><br><span class="line">    &lt;thymeleaf-layout-dialect.version&gt;2.3.0&lt;/thymeleaf-layout-dialect.version&gt;</span><br><span class="line"></span><br><span class="line">    &lt;thymeleaf-extras-springsecurity4.version&gt;3.0.2.RELEASE&lt;/thymeleaf-extras-springsecurity4.version&gt;</span><br><span class="line"></span><br><span class="line">&lt;/properties&gt;</span><br></pre></td></tr></table></figure><h2 id="3-自定义security策略，需要继承WebSecurityConfigurerAdapter类，通过修改configure来进行授权和认证。并且使用-EnableWebSecirity注解开启WebSecurity模式。"><a href="#3-自定义security策略，需要继承WebSecurityConfigurerAdapter类，通过修改configure来进行授权和认证。并且使用-EnableWebSecirity注解开启WebSecurity模式。" class="headerlink" title="3.自定义security策略，需要继承WebSecurityConfigurerAdapter类，通过修改configure来进行授权和认证。并且使用@EnableWebSecirity注解开启WebSecurity模式。"></a>3.自定义security策略，需要继承WebSecurityConfigurerAdapter类，通过修改configure来进行授权和认证。并且使用@EnableWebSecirity注解开启WebSecurity模式。</h2><p><strong>configure(HttpSecurity http)</strong>方法来定制授权的规则，规定访问哪个页面需要拥有哪些权限才可以访问该页面，该方法中还提供了用户没有权限需要登入的方法 <strong>http.formLogin()</strong>，注销 <strong>http.logout()</strong>，记住用户<strong>http.rememberMe()</strong>。</p><p><strong>configure(AuthenticationManagerBuilder auth)</strong>方法来进行权限的认证，给定用户权限。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">//自定义Security策略</span><br><span class="line"></span><br><span class="line"> //开启springsecurity注解</span><br><span class="line"></span><br><span class="line"> @EnableWebSecurity</span><br><span class="line"></span><br><span class="line"> public class MyWebSecurityConfig extends WebSecurityConfigurerAdapter &#123;</span><br><span class="line"></span><br><span class="line">     //用户授权</span><br><span class="line"></span><br><span class="line">     @Override</span><br><span class="line"></span><br><span class="line">     protected void configure(HttpSecurity http) throws Exception &#123;</span><br><span class="line"></span><br><span class="line">         //super.configure(http);</span><br><span class="line"></span><br><span class="line">         //进行定制授权规则   在/访问路径下都可以通过  给访问level1、level2、level3路径下各定一个角色role</span><br><span class="line"></span><br><span class="line">         http.authorizeRequests()</span><br><span class="line"></span><br><span class="line">                 .antMatchers(&quot;/&quot; ).permitAll()</span><br><span class="line"></span><br><span class="line">                 .antMatchers(&quot;/level1/**&quot;).hasRole(&quot;VIP1&quot;)</span><br><span class="line"></span><br><span class="line">                 .antMatchers(&quot;/level2/**&quot;).hasRole(&quot;VIP2&quot;)</span><br><span class="line"></span><br><span class="line">                 .antMatchers(&quot;/level3/**&quot;).hasRole(&quot;VIP3&quot;);</span><br><span class="line"></span><br><span class="line">         //开启登入  http.formLogin();默认访问/login</span><br><span class="line"></span><br><span class="line">         // 可以自定义登入的页面 自定义登录的页面的用户名和密码通过name属性传过来 这里配置获取</span><br><span class="line"></span><br><span class="line">         //http.formLogin().usernameParameter(&quot;user&quot;).passwordParameter(&quot;pwd&quot;).loginPage(&quot;/userlogin&quot;);</span><br><span class="line"></span><br><span class="line">         http.formLogin();</span><br><span class="line"></span><br><span class="line">         //开启注销   http.logout();//默认访问/logout  销毁cookie</span><br><span class="line"></span><br><span class="line">         http.logout().logoutSuccessUrl(&quot;/&quot;);//自定义注销后跳转到首页</span><br><span class="line"></span><br><span class="line">         //开启记住用户   开启浏览器访问自动登录</span><br><span class="line"></span><br><span class="line">         //在自定义的登录页面添加rememberme的方式  在页面提供一个name=“remeber”的属性  这里配置获取即可</span><br><span class="line"></span><br><span class="line">         //http.rememberMe().rememberMeParameter(&quot;remeber&quot;);</span><br><span class="line"></span><br><span class="line">         http.rememberMe();</span><br><span class="line"></span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     //自定义认证策略</span><br><span class="line"></span><br><span class="line">     //用户认证</span><br><span class="line"></span><br><span class="line">     @Override</span><br><span class="line"></span><br><span class="line">     protected void configure(AuthenticationManagerBuilder auth) throws Exception &#123;</span><br><span class="line"></span><br><span class="line">         //super.configure(auth);</span><br><span class="line"></span><br><span class="line">         //进行权限的认证 给定某个用户角色role</span><br><span class="line"></span><br><span class="line">         auth.inMemoryAuthentication()</span><br><span class="line"></span><br><span class="line">                 .withUser(&quot;zhangsan&quot;).password(&quot;123456&quot;).roles(&quot;VIP1&quot;,&quot;VIP2&quot;)</span><br><span class="line"></span><br><span class="line">                 .and()</span><br><span class="line"></span><br><span class="line">                 .withUser(&quot;lisi&quot;).password(&quot;123456&quot;).roles(&quot;VIP2&quot;,&quot;VIP3&quot;);</span><br><span class="line"></span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure><h2 id="4-html页面使用获得权限认证的相关操作，需要添加命名空间"><a href="#4-html页面使用获得权限认证的相关操作，需要添加命名空间" class="headerlink" title="4.html页面使用获得权限认证的相关操作，需要添加命名空间"></a>4.html页面使用获得权限认证的相关操作，需要添加命名空间</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;html xmlns:th=&quot;http://www.thymeleaf.org&quot;</span><br><span class="line"></span><br><span class="line">        xmlns:sec=&quot;http://www.thymeleaf.org/thymeleaf-extras-springsecurity4&quot;&gt;</span><br></pre></td></tr></table></figure><p>相关语法和操作：</p><blockquote><p> <strong>sec:authorize=”isAuthenticated()”</strong>：判断用户是否拥有权限，该用户是否已经授权</p></blockquote><blockquote><p>  <strong>sec:authentication=”name”</strong>：获取到已授权用户的用户名name</p></blockquote><blockquote><p><strong>sec:authentication=”principal.authorities”</strong>：获取到已授权用户所拥有的权限</p></blockquote><blockquote><p><strong>sec:authorize=”hasRole(‘VIP1’)”</strong>：判断用户拥有VIP1的权限才可以显示该内容  VIP1是自定义的一个Role</p></blockquote> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--使用sec来判断是否有授权--&gt;</span><br><span class="line"></span><br><span class="line"> &lt;div sec:authorize=&quot;!isAuthenticated()&quot;&gt;</span><br><span class="line"></span><br><span class="line">       &lt;h1 align=&quot;center&quot;&gt;欢迎光临武林秘籍管理系统&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line">       &lt;h2 align=&quot;center&quot;&gt;游客您好，如果想查看武林秘籍 请登录&lt;/h2&gt;</span><br><span class="line"></span><br><span class="line"> &lt;/div&gt;</span><br><span class="line"></span><br><span class="line"> &lt;hr&gt;</span><br><span class="line"></span><br><span class="line"> &lt;div sec:authorize=&quot;isAuthenticated()&quot;&gt;</span><br><span class="line"></span><br><span class="line">       &lt;!--使用sec来获取已经授权的用户名name 和拥有的权限--&gt;</span><br><span class="line"></span><br><span class="line">       &lt;h1&gt;&lt;span sec:authentication=&quot;name&quot;&gt;&lt;/span&gt;，你好，你的权限有：&lt;span sec:authentication=&quot;principal.authorities&quot;&gt;&lt;/span&gt;&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line">       &lt;form th:action=&quot;@&#123;/logout&#125;&quot; method=&quot;post&quot;&gt;</span><br><span class="line"></span><br><span class="line">             &lt;input type=&quot;submit&quot; value=&quot;注销&quot;&gt;</span><br><span class="line"></span><br><span class="line">       &lt;/form&gt;</span><br><span class="line"></span><br><span class="line"> &lt;/div&gt;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">&lt;!--将数据进行权限分类显示--&gt;</span><br><span class="line"></span><br><span class="line"> &lt;div sec:authorize=&quot;hasRole(&apos;VIP1&apos;)&quot;&gt;</span><br><span class="line"></span><br><span class="line">       &lt;h3&gt;普通武功秘籍&lt;/h3&gt;</span><br><span class="line"></span><br><span class="line">       &lt;ul&gt;</span><br><span class="line"></span><br><span class="line">             &lt;li&gt;罗汉拳&lt;/li&gt;</span><br><span class="line"></span><br><span class="line">             &lt;li&gt;武当长拳&lt;/li&gt;</span><br><span class="line"></span><br><span class="line">             &lt;li&gt;全真剑法&lt;/li&gt;</span><br><span class="line"></span><br><span class="line">       &lt;/ul&gt;</span><br><span class="line"></span><br><span class="line"> &lt;/div&gt;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;1-spring-security是springboot底层默认使用的安全模块，主要通过WebSecurityConfigurerAdapter类中的configure来进行授权（Authorization）和认证（Authentication），实现安全。&quot;&gt;&lt;a href=&quot;#1-spring-security是springboot底层默认使用的安全模块，主要通过WebSecurityConfigurerAdapter类中的configure来进行授权（Authorization）和认证（Authentication），实现安全。&quot; class=&quot;headerlink&quot; title=&quot;1.spring security是springboot底层默认使用的安全模块，主要通过WebSecurityConfigurerAdapter类中的configure来进行授权（Authorization）和认证（Authentication），实现安全。&quot;&gt;&lt;/a&gt;1.spring security是springboot底层默认使用的安全模块&lt;/h2&gt;
    
    </summary>
    
    
      <category term="springboot" scheme="http://yoursite.com/tags/springboot/"/>
    
      <category term="security" scheme="http://yoursite.com/tags/security/"/>
    
      <category term="thymeleaf" scheme="http://yoursite.com/tags/thymeleaf/"/>
    
  </entry>
  
  <entry>
    <title>springboot-task 任务(九)</title>
    <link href="http://yoursite.com/2019/04/12/springboot-task/"/>
    <id>http://yoursite.com/2019/04/12/springboot-task/</id>
    <published>2019-04-12T07:25:21.000Z</published>
    <updated>2019-04-12T07:32:44.987Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-springboot任务有-异步-、-定时-、邮件"><a href="#1-springboot任务有-异步-、-定时-、邮件" class="headerlink" title="1.springboot任务有 异步 、 定时 、邮件"></a>1.springboot任务有 异步 、 定时 、邮件<a id="more"></a></h2><p>异步注解：</p><p>  <strong>@EnableAsync</strong>  开启异步注解的方式</p><p>  <strong>@Async</strong>   在方法上开启异步</p><p>定时注解：</p><p>  <strong>@EnableScheduling</strong>  开启定时注解的方式</p><p>  <strong>@Scheduled(cron=”0 <em> </em> <em> </em> *”)</strong>  在方法上开启定时任务  当整秒时执行该方法</p><p>​     <strong>cron</strong>中的参数为 秒 分 时 日 月 星期  6位。</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">//异步处理</span><br><span class="line"></span><br><span class="line"> @Async</span><br><span class="line"></span><br><span class="line"> public void sleepTime()&#123;</span><br><span class="line"></span><br><span class="line">     try &#123;</span><br><span class="line"></span><br><span class="line">         Thread.sleep(3000);</span><br><span class="line"></span><br><span class="line">     &#125; catch (InterruptedException e) &#123;</span><br><span class="line"></span><br><span class="line">         e.printStackTrace();</span><br><span class="line"></span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> //定时  cron=&quot;秒 分 时 日 月 星期&quot;</span><br><span class="line"></span><br><span class="line"> @Scheduled(cron = &quot;0 * * * * *&quot;)//整秒启动该方法  即1分钟启动一次</span><br><span class="line"></span><br><span class="line"> public void scheduled()&#123;</span><br><span class="line"></span><br><span class="line">     System.out.println(&quot;定时启动。。。。。&quot;);</span><br><span class="line"></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>cron中参数的表达式写法：</p><p><img src="/2019/04/12/springboot-task/1.jpg" alt="img"></p><h2 id="2-springboot任务中的邮件"><a href="#2-springboot任务中的邮件" class="headerlink" title="2.springboot任务中的邮件"></a>2.springboot任务中的邮件</h2><p>在pom文件中依然邮件的依赖</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--引入邮箱依赖--&gt;</span><br><span class="line"></span><br><span class="line"> &lt;dependency&gt;</span><br><span class="line"></span><br><span class="line">     &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line"></span><br><span class="line">     &lt;artifactId&gt;spring-boot-starter-mail&lt;/artifactId&gt;</span><br><span class="line"></span><br><span class="line"> &lt;/dependency&gt;</span><br></pre></td></tr></table></figure><p>在配置文件中配置邮件信息 如用户username、密码password（密码是获取smtp授权码的方式），smtp地址（固定的），设置安全组件ssl</p><blockquote><p>#设置邮箱信息  发送方信息<br> <a href="mailto:spring.mail.username=1558095899@qq.com" target="_blank" rel="noopener">spring.mail.username=1558095899@qq.com</a><br> #此处需要登入qq邮箱进入设置获取smtp授权码  手机发送短信验证即可<br> spring.mail.password=nhjbweqjnoqxhfaa<br> #填写smtp地址<br> spring.mail.host=smtp.qq.com<br> #设置安全ssl<br> spring.mail.properties.mail.smtp.ssl.enable=true</p></blockquote><p>qq邮箱获取授权码</p><p><img src="/2019/04/12/springboot-task/2.jpg" alt="img"></p><h2 id="3-springboot使用JavaMailSenderImpl类来处理发送邮件"><a href="#3-springboot使用JavaMailSenderImpl类来处理发送邮件" class="headerlink" title="3.springboot使用JavaMailSenderImpl类来处理发送邮件"></a>3.springboot使用JavaMailSenderImpl类来处理发送邮件</h2><p>发送简单的邮件，使用<strong>SimpleMailMessage</strong>对象，该类提供了设置邮件的标题Subject、邮件的内容Test、邮件的发送者和接收者</p><p>使用send方法将设置好的邮件进行发送</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line"></span><br><span class="line"> public void contextLoads() &#123;</span><br><span class="line"></span><br><span class="line">     //发送简单的邮件</span><br><span class="line"></span><br><span class="line">     SimpleMailMessage message = new SimpleMailMessage();</span><br><span class="line"></span><br><span class="line">     //设置邮件</span><br><span class="line"></span><br><span class="line">     message.setSubject(&quot;开会&quot;);  //邮件标题</span><br><span class="line"></span><br><span class="line">     message.setText(&quot;今晚七点开会，地点厚德楼&quot;);//邮件内容</span><br><span class="line"></span><br><span class="line">     message.setTo(&quot;18877545427@163.com&quot;);//接收邮件对象</span><br><span class="line"></span><br><span class="line">     message.setFrom(&quot;1558095899@qq.com&quot;);//发送者</span><br><span class="line"></span><br><span class="line">//将邮件发送</span><br><span class="line"></span><br><span class="line">    mailSender.send(message);</span><br><span class="line"></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>发送复杂的邮件，如邮件有附件。使用<strong>MimeMessageHelper</strong>对象来对邮件进行设置。并且可以设置发送上传文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line"></span><br><span class="line"> public void test() throws Exception&#123;</span><br><span class="line"></span><br><span class="line">     //创建复杂邮件</span><br><span class="line"></span><br><span class="line">     MimeMessage mimeMessage = mailSender.createMimeMessage();</span><br><span class="line"></span><br><span class="line">     MimeMessageHelper helper = new MimeMessageHelper(mimeMessage, true);</span><br><span class="line"></span><br><span class="line">     //设置邮件</span><br><span class="line"></span><br><span class="line">     helper.setSubject(&quot;开会&quot;);  //邮件标题</span><br><span class="line"></span><br><span class="line">     helper.setText(&quot;今晚七点开会，地点厚德楼&quot;,true);//邮件内容</span><br><span class="line"></span><br><span class="line">     helper.setTo(&quot;18877545427@163.com&quot;);//接收邮件对象</span><br><span class="line"></span><br><span class="line">     helper.setFrom(&quot;1558095899@qq.com&quot;);//发送者</span><br><span class="line"></span><br><span class="line">     //上传文件                              文件名         文件</span><br><span class="line"></span><br><span class="line">     helper.addAttachment(&quot;2.png&quot;,new File(&quot;C:\Users\18877545427\Pictures\Saved Pictures\oo\2.png&quot;));</span><br><span class="line"></span><br><span class="line">     mailSender.send(mimeMessage);</span><br><span class="line"></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;1-springboot任务有-异步-、-定时-、邮件&quot;&gt;&lt;a href=&quot;#1-springboot任务有-异步-、-定时-、邮件&quot; class=&quot;headerlink&quot; title=&quot;1.springboot任务有 异步 、 定时 、邮件&quot;&gt;&lt;/a&gt;1.springboot任务有 异步 、 定时 、邮件&lt;/h2&gt;
    
    </summary>
    
    
      <category term="springboot" scheme="http://yoursite.com/tags/springboot/"/>
    
      <category term="task" scheme="http://yoursite.com/tags/task/"/>
    
      <category term="async" scheme="http://yoursite.com/tags/async/"/>
    
      <category term="scheduled" scheme="http://yoursite.com/tags/scheduled/"/>
    
      <category term="mail" scheme="http://yoursite.com/tags/mail/"/>
    
  </entry>
  
  <entry>
    <title>springboot-elasticsearch 检索(八)</title>
    <link href="http://yoursite.com/2019/04/12/springboot-elasticsearch/"/>
    <id>http://yoursite.com/2019/04/12/springboot-elasticsearch/</id>
    <published>2019-04-12T07:15:17.000Z</published>
    <updated>2019-04-12T07:24:00.785Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-准备Elasticsearch环境"><a href="#1-准备Elasticsearch环境" class="headerlink" title="1.准备Elasticsearch环境"></a>1.准备Elasticsearch环境<a id="more"></a></h2><p>下载ElasticSearch，下载地址：<a href="https://www.elastic.co/cn/downloads/elasticsearch" target="_blank" rel="noopener">https://www.elastic.co/cn/downloads/elasticsearch</a>   。之后解压即可， 进入解压目录的bin下双击  elasticsearch.bat，该脚本文件执行 ElasticSearch 安装程序，默认使用端口<strong>9200</strong>，访问地址：<a href="http://localhost:9200。" target="_blank" rel="noopener">http://localhost:9200。</a></p><h2 id="2-springboot创建项目"><a href="#2-springboot创建项目" class="headerlink" title="2.springboot创建项目"></a>2.springboot创建项目</h2><p>elasticsearch在Nosql模块下。pom文件中自动生成的elasticsearch依赖加上版本号，之前用的springboot版本为1.5.9。但这里使用该版本会报错，使用了最新版本的elasticsearch。将springboot的版本升级为2.1.4.（之前创建新项目使用2以上的版本启动后会报找不到加载主类这个问题）</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line"></span><br><span class="line">     &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line"></span><br><span class="line">     &lt;artifactId&gt;spring-boot-starter-data-elasticsearch&lt;/artifactId&gt;</span><br><span class="line"></span><br><span class="line">     &lt;!--加上elasticsearch的版本--&gt;</span><br><span class="line"></span><br><span class="line">     &lt;version&gt;2.0.4.RELEASE&lt;/version&gt;</span><br><span class="line"></span><br><span class="line"> &lt;/dependency&gt;</span><br></pre></td></tr></table></figure><h2 id="3-在配置文件中配置name-和-nodes"><a href="#3-在配置文件中配置name-和-nodes" class="headerlink" title="3.在配置文件中配置name 和 nodes"></a>3.在配置文件中配置name 和 nodes</h2><blockquote><p>#配置Elasticsearch的name 和node   访问地址默认9200<br>#页面查询地址  <a href="http://127.0.0.1:9200/atguigu/book/_search" target="_blank" rel="noopener">http://127.0.0.1:9200/atguigu/book/_search</a><br>spring.data.elasticsearch.cluster-name=elasticsearch<br>spring.data.elasticsearch.cluster-nodes=127.0.0.1:9300</p></blockquote><h2 id="4-springboot中提供ElasticSearchRepository接口来对其进行操作"><a href="#4-springboot中提供ElasticSearchRepository接口来对其进行操作" class="headerlink" title="4.springboot中提供ElasticSearchRepository接口来对其进行操作"></a>4.springboot中提供ElasticSearchRepository接口来对其进行操作</h2><p>定义一个接口，继承ElasticsearchRepository接口，该接口需要两个参数，一个是数据类型，和ID类型，如果是发布数据不需要写方法，提供方法就是查询数据，并且方法要有一定的规范</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">//页面查询地址  http://127.0.0.1:9200/atguigu/book/_search</span><br><span class="line"></span><br><span class="line"> //使用ElasticsearchRepository的子接口进行检索  父接口需要两个参数    类型  、 id</span><br><span class="line"></span><br><span class="line"> public interface BookRepository extends ElasticsearchRepository&lt;Book,Integer&gt; &#123;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">     //模糊查询数据   Book&#123;id=1, name=&apos;我的青春恋爱物语果然有问题&apos;, author=&apos;渡航&apos;&#125;</span><br><span class="line"></span><br><span class="line">     //方法命名有规定   findBy+Book实体类中的Name属性+Like为模糊查询</span><br><span class="line"></span><br><span class="line">     public List&lt;Book&gt; findByNameLike(String name);</span><br><span class="line"></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>创建一个实体类Book，封装数据，该类作为要发布的数据对象，需要在该实体类上要使用<strong>@Document</strong>标明，使用<strong>indexNam</strong>e属性为索引名称 使用<strong>type</strong>标明类型。之后的访问地址就是</p><blockquote><p><a href="http://127.0.0.1:9200/atguigu/book/_search" target="_blank" rel="noopener">http://127.0.0.1:9200/atguigu/book/_search</a>     查询出所有的数据</p></blockquote> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">//查询地址为 http://127.0.0.1:9200/atguigu/book/_search</span><br><span class="line"></span><br><span class="line"> //查询地址为 http://127.0.0.1:9200/atguigu/book/1</span><br><span class="line"></span><br><span class="line"> //图书 需要使用Document注解标明该实体类   索引的名字indexName  索引的类型type</span><br><span class="line"></span><br><span class="line"> @Document(indexName = &quot;atguigu&quot;,type = &quot;book&quot;)</span><br><span class="line"></span><br><span class="line"> public class Book &#123;</span><br><span class="line"></span><br><span class="line">     private Integer id;</span><br><span class="line"></span><br><span class="line">     private String name;</span><br><span class="line"></span><br><span class="line">     private String author;</span><br></pre></td></tr></table></figure><h2 id="5-将该数据发布"><a href="#5-将该数据发布" class="headerlink" title="5.将该数据发布"></a>5.将该数据发布</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">@Autowired</span><br><span class="line"></span><br><span class="line"> BookRepository bookRepository;</span><br><span class="line"></span><br><span class="line"> @Test</span><br><span class="line"></span><br><span class="line"> public void contextLoads() &#123;</span><br><span class="line"></span><br><span class="line">     //页面查询地址  http://127.0.0.1:9200/atguigu/book/_search</span><br><span class="line"></span><br><span class="line">     Book book = new Book();</span><br><span class="line"></span><br><span class="line">     book.setId(1);</span><br><span class="line"></span><br><span class="line">     book.setName(&quot;我的青春恋爱物语果然有问题&quot;);</span><br><span class="line"></span><br><span class="line">     book.setAuthor(&quot;渡航&quot;);</span><br><span class="line"></span><br><span class="line">     //使用ElasticsearchRepository的子类对象进行发布</span><br><span class="line"></span><br><span class="line">     bookRepository.index(book);</span><br></pre></td></tr></table></figure><h2 id="6-查询数据，在ElasticsearchRepository的子接口中提供查询数据的方法"><a href="#6-查询数据，在ElasticsearchRepository的子接口中提供查询数据的方法" class="headerlink" title="6.查询数据，在ElasticsearchRepository的子接口中提供查询数据的方法"></a>6.查询数据，在ElasticsearchRepository的子接口中提供查询数据的方法</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">@Autowired</span><br><span class="line"></span><br><span class="line"> BookRepository bookRepository;</span><br><span class="line"></span><br><span class="line"> @Test</span><br><span class="line"></span><br><span class="line"> public void contextLoads() &#123;</span><br><span class="line"></span><br><span class="line">     //模糊查询数据   Book&#123;id=1, name=&apos;我的青春恋爱物语果然有问题&apos;, author=&apos;渡航&apos;&#125;</span><br><span class="line"></span><br><span class="line">     //方法命名有规定   固定findBy+Book实体类中的name属性首字母大写+Like为模糊查询</span><br><span class="line"></span><br><span class="line">     List&lt;Book&gt; result= bookRepository.findByNameLike(&quot;青春&quot;);</span><br><span class="line"></span><br><span class="line">     for(Book b:result)&#123;</span><br><span class="line"></span><br><span class="line">         System.out.println(b);</span><br><span class="line"></span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;1-准备Elasticsearch环境&quot;&gt;&lt;a href=&quot;#1-准备Elasticsearch环境&quot; class=&quot;headerlink&quot; title=&quot;1.准备Elasticsearch环境&quot;&gt;&lt;/a&gt;1.准备Elasticsearch环境&lt;/h2&gt;
    
    </summary>
    
    
      <category term="springboot" scheme="http://yoursite.com/tags/springboot/"/>
    
      <category term="elasticsearch" scheme="http://yoursite.com/tags/elasticsearch/"/>
    
  </entry>
  
  <entry>
    <title>springboot-rabbitmq 消息队列(七)</title>
    <link href="http://yoursite.com/2019/04/12/springboot-rabbitmq/"/>
    <id>http://yoursite.com/2019/04/12/springboot-rabbitmq/</id>
    <published>2019-04-12T06:56:53.000Z</published>
    <updated>2019-04-12T07:12:03.591Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-RabbitMQ下载安装，配置环境变量。"><a href="#1-RabbitMQ下载安装，配置环境变量。" class="headerlink" title="1.RabbitMQ下载安装，配置环境变量。"></a>1.RabbitMQ下载安装，配置环境变量。<a id="more"></a></h2><p>先下载erlang，下载地址：<a href="http://www.erlang.org/downloads。" target="_blank" rel="noopener">http://www.erlang.org/downloads。</a> 文件进行安装就好，安装完成之后创建一个名为ERLANG_HOME的环境变量，其值指向erlang的安装目录，同时将%ERLANG_HOME%\bin加入到Path中，最后打开命令行，输入erl，如果出现erlang的版本信息就表示erlang语言环境安装成功</p><p>下载RabbitMQ，下载地址：<a href="http://www.rabbitmq.com/download.html" target="_blank" rel="noopener">http://www.rabbitmq.com/download.html</a> 。打开命令行cd进入rabbitmq的sbin目录输入：<strong>rabbitmq-plugins enable rabbitmq_managemen</strong>t命令（双击rabbitmq-service.bat启动）</p><p>RabbitMQ默认使用的访问端口为<strong>15672</strong>，默认的用户名和密码都是<strong>guest</strong>   访问地址：<a href="http://localhost:15672/" target="_blank" rel="noopener">http://localhost:15672/</a></p><p>RabbitMQ概念：</p><ul><li>Exchange 交换器，主要使用Direct（点对点模式、单播模式）、fanout（广播模式，只有对一个队列发布消息，所有绑定的队列都会有消息）、topic（匹配模式，只要符合绑定的规则就会对其发布）</li><li>Queue  消息队列</li><li>Binding  绑定交换器与消息队列的对应，使用路由键来确定其之间的关系</li></ul><h2 id="2-创建springboot，选中RabbitMQ模块、web模块。"><a href="#2-创建springboot，选中RabbitMQ模块、web模块。" class="headerlink" title="2.创建springboot，选中RabbitMQ模块、web模块。"></a>2.创建springboot，选中RabbitMQ模块、web模块。</h2><p>首先，在配置文件中配置RabbitMQ的用户名和密码、主机ip地址等</p><blockquote><p>配置RabbitMQ主机ip地址  RabbitMQ的访问端口为15672<br>spring.rabbitmq.host=127.0.0.1<br>#配置RabbitMQ的默认的用户名和密码<br>spring.rabbitmq.username=guest<br>spring.rabbitmq.password=guest</p></blockquote><h2 id="3-使用RabbitTemplate类来对消息进行操作"><a href="#3-使用RabbitTemplate类来对消息进行操作" class="headerlink" title="3.使用RabbitTemplate类来对消息进行操作"></a>3.使用RabbitTemplate类来对消息进行操作</h2><p><strong>RabbitTemplate</strong>提供发送消息的方法<strong>converterAndSend</strong>，该方法的参数有交换器名称，路由键（即绑定的规则），需要传输的数据可以是对象</p><p><strong>RabbitTemplate</strong>默认对消息进行序列化。我们可以修改amqp包下的<strong>MessageConverter</strong>类，将<strong>Jackson2JsonMessageConverter</strong>对象放入容器中， 即可获取json格式的数据消息。</p><p><strong>RabbitTemplate</strong>提供接收消息的方法<strong>receiverAndConverter</strong>,该方法需要参数是确定取出的队列的名称。</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">@Autowired</span><br><span class="line"></span><br><span class="line"> RabbitTemplate rabbitTemplate;//使用RabbitTemplate对象来对rabbit进行操作</span><br><span class="line"></span><br><span class="line"> @Test</span><br><span class="line"></span><br><span class="line"> public void send()&#123;</span><br><span class="line"></span><br><span class="line">     //发送消息   rabbit默认对数据序列化  我们可以自定义数据序列化为json格式类型使用MessageConverter对象 如MyRabbitConfig</span><br><span class="line"></span><br><span class="line">     HashMap&lt;String, Object&gt; map = new HashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">     map.put(&quot;exchange&quot;,&quot;direct&quot;);</span><br><span class="line"></span><br><span class="line">     map.put(&quot;message&quot;, Arrays.asList(&quot;hello world&quot;,&quot;第一个消息&quot;));</span><br><span class="line"></span><br><span class="line">     //direct  点对点模式</span><br><span class="line"></span><br><span class="line">     //第一个参数exchange：交换器  我们定义的exchange.direct</span><br><span class="line"></span><br><span class="line">     //第二个参数routingKey：路由键 自定义的绑定规则  atguigu.news</span><br><span class="line"></span><br><span class="line">     //第三个参数Object: 给消息队列发送的消息 可以发送对象</span><br><span class="line"></span><br><span class="line">     rabbitTemplate.convertAndSend(&quot;exchange.direct&quot;,&quot;atguigu.emps&quot;,map);</span><br><span class="line"></span><br><span class="line">     //fanout 广播模式  路由键不需要写  确定交换器fanout即可</span><br><span class="line"></span><br><span class="line">     //rabbitTemplate.convertAndSend(&quot;exchange.fanout&quot;,&quot;&quot;,map);</span><br><span class="line"></span><br><span class="line">     //topic  匹配模式</span><br><span class="line"></span><br><span class="line">    // rabbitTemplate.convertAndSend(&quot;exchange.topic&quot;,&quot;atguigu.#&quot;,map);</span><br><span class="line"></span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> @Test</span><br><span class="line"></span><br><span class="line"> public void contextLoads() &#123;</span><br><span class="line"></span><br><span class="line">     //接收消息队列的消息</span><br><span class="line"></span><br><span class="line">     //参数为 自定义的消息队列的名称</span><br><span class="line"></span><br><span class="line">     Object o = rabbitTemplate.receiveAndConvert(&quot;atguigu.emps&quot;);</span><br><span class="line"></span><br><span class="line">     System.out.println(o);</span><br><span class="line"></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><h2 id="4-配置RabbitMQ消息队列的监听器"><a href="#4-配置RabbitMQ消息队列的监听器" class="headerlink" title="4.配置RabbitMQ消息队列的监听器"></a>4.配置RabbitMQ消息队列的监听器</h2><p>  首先，在程序主入口上配置<strong>@EnableRabbit</strong> 开启Rabbit注解方式。在方法上使用<strong>@RabbitListener</strong>注解 以queues属性来确定要监听的消息队列，只要该队列有数据就会监听到，并执行该方法</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">@Service</span><br><span class="line"></span><br><span class="line"> public class MyService &#123;</span><br><span class="line"></span><br><span class="line">     //对消息队列进行监听  并确定监听哪个消息队列  只要有消息到atguigu.news队列中就会执行</span><br><span class="line"></span><br><span class="line">     @RabbitListener(queues = &quot;atguigu.news&quot;)</span><br><span class="line"></span><br><span class="line">     public void rabbitListenner()&#123;</span><br><span class="line"></span><br><span class="line">         System.out.println(&quot;队列接收到消息！！&quot;);</span><br><span class="line"></span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><h2 id="5-使用AmqpAdmin对象来创建Exchange交换器、queue消息队列、bingding绑定规则"><a href="#5-使用AmqpAdmin对象来创建Exchange交换器、queue消息队列、bingding绑定规则" class="headerlink" title="5.使用AmqpAdmin对象来创建Exchange交换器、queue消息队列、bingding绑定规则"></a>5.使用AmqpAdmin对象来创建Exchange交换器、queue消息队列、bingding绑定规则</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">@Autowired</span><br><span class="line"></span><br><span class="line"> AmqpAdmin amqpAdmin;//用java代码的方式创建交换器Exchange、消息队列Queue、绑定规则Bingding</span><br><span class="line"></span><br><span class="line"> @Test</span><br><span class="line"></span><br><span class="line"> public void test()&#123;</span><br><span class="line"></span><br><span class="line">     //创建交换器Exchange  指定交换器的类型为点对点（Direct） 并命名</span><br><span class="line"></span><br><span class="line">     amqpAdmin.declareExchange(new DirectExchange(&quot;amqpAdmin.exchange&quot;));</span><br><span class="line"></span><br><span class="line">     //创建消息队列</span><br><span class="line"></span><br><span class="line">     amqpAdmin.declareQueue(new Queue(&quot;amqpAdmin.queue&quot;));</span><br><span class="line"></span><br><span class="line">     //进行绑定</span><br><span class="line"></span><br><span class="line">     // 参数为：目的地即消息队列，目的地类型，指定交换器，规定一个路由键即绑定规则，传递的参数为null</span><br><span class="line"></span><br><span class="line">     amqpAdmin.declareBinding(new Binding(&quot;amqpAdmin.queue&quot;,Binding.DestinationType.QUEUE,</span><br><span class="line"></span><br><span class="line">             &quot;amqpAdmin.exchange&quot;,&quot;amqp.hh&quot;,null));</span><br><span class="line"></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;1-RabbitMQ下载安装，配置环境变量。&quot;&gt;&lt;a href=&quot;#1-RabbitMQ下载安装，配置环境变量。&quot; class=&quot;headerlink&quot; title=&quot;1.RabbitMQ下载安装，配置环境变量。&quot;&gt;&lt;/a&gt;1.RabbitMQ下载安装，配置环境变量。&lt;/h2&gt;
    
    </summary>
    
    
      <category term="springboot" scheme="http://yoursite.com/tags/springboot/"/>
    
      <category term="rabbitmq" scheme="http://yoursite.com/tags/rabbitmq/"/>
    
  </entry>
  
  <entry>
    <title>springboot-data-cache-redis 缓存(六)</title>
    <link href="http://yoursite.com/2019/04/12/springboot-data-cache-redis/"/>
    <id>http://yoursite.com/2019/04/12/springboot-data-cache-redis/</id>
    <published>2019-04-12T06:38:46.000Z</published>
    <updated>2019-04-12T06:51:22.290Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-springboot默认使用SimpleCacheManager作为缓存管理器，配置文件配置基本的数据源的信息，并开启驼峰命名"><a href="#1-springboot默认使用SimpleCacheManager作为缓存管理器，配置文件配置基本的数据源的信息，并开启驼峰命名" class="headerlink" title="1.springboot默认使用SimpleCacheManager作为缓存管理器，配置文件配置基本的数据源的信息，并开启驼峰命名"></a>1.springboot默认使用SimpleCacheManager作为缓存管理器<a id="more"></a>，配置文件配置基本的数据源的信息，并开启驼峰命名</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#开启驼峰命名法</span><br><span class="line"></span><br><span class="line">mybatis.configuration.map-underscore-to-camel-case=true</span><br></pre></td></tr></table></figure><p>在程序的主入口使用注解@MapperScan(“com.springboot.cache.mapper”)包中进行扫描Mybatis的映射文件。 使用@EnableCache开启缓存</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">/扫描映射文件的包</span><br><span class="line"></span><br><span class="line"> @MapperScan(&quot;com.springboot.cache.mapper&quot;)</span><br><span class="line"></span><br><span class="line"> @SpringBootApplication</span><br><span class="line"></span><br><span class="line"> //开启缓存</span><br><span class="line"></span><br><span class="line"> @EnableCaching</span><br><span class="line"></span><br><span class="line"> public class SpringbootCacheRedisApplication &#123;</span><br></pre></td></tr></table></figure><h2 id="2-在Service层中对方法进行相应的进行缓存、更新、删除操作。"><a href="#2-在Service层中对方法进行相应的进行缓存、更新、删除操作。" class="headerlink" title="2.在Service层中对方法进行相应的进行缓存、更新、删除操作。"></a>2.在Service层中对方法进行相应的进行缓存、更新、删除操作。</h2><p><strong>@EnableCaching</strong>：开启缓存注解</p><p>进行缓存的注解：其要指明cacheNames或者是value，标出key，如果没有key，默认使用参数作为key值</p><p>​           condition：当条件符合时执行。unless：当条件符合时不执行</p><p><strong>@Cacheable(cacheNames=”emp”,key=”#id”,condition=”#id&gt;0”,unless=”#id=2”)</strong></p><p>更新缓存的注解：其中更新数据库中的数据后并把更新过的数据存储到缓存中，需要注意的是如果更新的key和进行缓存的key不一致时，并不能查询到缓存中更新后的数据，更新后，数据存入cacheNames=“emp”的缓存中 但再次查询数据时并不是更新后的数据@CachePut中 key=”#result.id”相当于key=”#对象.id” 并且该方法上要有return才能获得result   @Cacheable中不能使用result</p><p><strong>@CachePut(cacheNames=”emp”,key=”#result.id”）</strong></p><p>删除缓存的注解：</p><ul><li>allEntries = true 执行该将缓存中的所有数据删除掉</li><li>beforeInvocation  指定缓存的清除是否在方法之前，默认false</li><li>beforeInvocation=false  默认在方法执行之后执行   当出现异常时不会执行缓存清除</li><li>beforeInvocation=true   在方法执行之前执行   方法中出现异常也会清除缓存</li></ul><p><strong>@CacheEvict(cacheNames=”emp”,key=”#id”)</strong></p><p><strong>@CacheConfig(cacheNames=”emp”)</strong>  ：在类上使用在注解是 全局配置该类下所有的cacheNames</p><h2 id="3-springboot整合redis进行缓存"><a href="#3-springboot整合redis进行缓存" class="headerlink" title="3.springboot整合redis进行缓存"></a>3.springboot整合redis进行缓存</h2><p>  首先，在pom文件中引入redis的依赖</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--引入redis的依赖--&gt;</span><br><span class="line"></span><br><span class="line"> &lt;dependency&gt;</span><br><span class="line"></span><br><span class="line">     &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line"></span><br><span class="line">     &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;</span><br><span class="line"></span><br><span class="line">     &lt;version&gt;1.5.2.RELEASE&lt;/version&gt;</span><br><span class="line"></span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><p>在配置文件中配置  连接redis主机的ip地址  </p><blockquote><p>spring.redis.host=192.168.220.130</p></blockquote><p>springboot中对Redis的操作提供了StringRedisTemplate类来进行操作字符串和RedisTemplate类来操作对象 ，向Redis缓存中存入Employee对象 必须把该实体类（Employee）实现序列化 Serializable，但Redis中保存的数据并不是以json的方式储存  需要我们手动更改实例化配置的规则，修改RedisAutoConfiguration配置文件中的RedisTemplate方法，并将其放入容器中 MyRedisConfig类中</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      * Redis操作的数据类型</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      *  stringRedisTemplate.opsForValue() 【字符串类型】</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      *  stringRedisTemplate.opsForList() 【list集合】</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      *  stringRedisTemplate.opsForSet() 【set集合】</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      *    stringRedisTemplate.opsForHash() 【map集合】</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      *</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line"></span><br><span class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">         <span class="comment">//Redis存取字符串</span></span><br><span class="line"></span><br><span class="line">         stringRedisTemplate.opsForValue().append(<span class="string">"name"</span>,<span class="string">"hello"</span>);<span class="comment">//向redis缓存中存入值</span></span><br><span class="line"></span><br><span class="line">         stringRedisTemplate.opsForValue().get(<span class="string">"name"</span>);<span class="comment">//向redis缓存中取数据</span></span><br><span class="line"></span><br><span class="line"> <span class="comment">//        stringRedisTemplate.opsForList().leftPush();</span></span><br><span class="line"></span><br><span class="line"> <span class="comment">//        stringRedisTemplate.opsForList().leftPop();</span></span><br><span class="line"></span><br><span class="line">         <span class="comment">//Redis存取对象</span></span><br><span class="line"></span><br><span class="line">         Employee emp = employeeService.findEmpById(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">         <span class="comment">//向Redis缓存中存入Employee对象  并必须把该实体类（Employee）实现序列化 Serializable</span></span><br><span class="line"></span><br><span class="line">         <span class="comment">//但Redis中保存的数据并不是以json的方式储存  需要我们手动更改实例化配置的规则</span></span><br><span class="line"></span><br><span class="line">         <span class="comment">//修改RedisAutoConfiguration配置文件中的RedisTemplate方法，并将其放入容器中 MyRedisConfig类中</span></span><br><span class="line"></span><br><span class="line">         <span class="comment">//redisTemplate.opsForValue().set("emp-01",emp);</span></span><br><span class="line"></span><br><span class="line">         empRedisTemplate.opsForValue().set(<span class="string">"emp-01"</span>,emp);<span class="comment">//此时Redis中的数据就是json格式的数据了</span></span><br><span class="line"></span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">自定义一个配置文件修改缓存管理器中的RedisTemplate</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="comment">//配置缓存管理器和存入为json格式的数据类型</span></span><br><span class="line"></span><br><span class="line"> <span class="meta">@Configuration</span></span><br><span class="line"></span><br><span class="line"> <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyRedisConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">     <span class="comment">//RedisTemplate默认使用jdk序列化机制</span></span><br><span class="line"></span><br><span class="line">     <span class="comment">//我们可以手动修改数据格式的配置     将数据以json的数据格式存入Redis缓存中</span></span><br><span class="line"></span><br><span class="line">     <span class="comment">//修改RedisAutoConfiguration类中RedisTemplate方法，并将其放入容器中</span></span><br><span class="line"></span><br><span class="line">     <span class="comment">//并修改存储的数据类型为 Employee</span></span><br><span class="line"></span><br><span class="line">     <span class="meta">@Bean</span></span><br><span class="line"></span><br><span class="line">     <span class="function"><span class="keyword">public</span> RedisTemplate&lt;Object, Employee&gt; <span class="title">empRedisTemplate</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">             RedisConnectionFactory redisConnectionFactory)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">             <span class="keyword">throws</span> UnknownHostException </span>&#123;</span><br><span class="line"></span><br><span class="line">         RedisTemplate&lt;Object, Employee&gt; template = <span class="keyword">new</span> RedisTemplate&lt;Object, Employee&gt;();</span><br><span class="line"></span><br><span class="line">         template.setConnectionFactory(redisConnectionFactory);</span><br><span class="line"></span><br><span class="line">         <span class="comment">//将序列化的实体类设置到序列化器中 并设置为默认</span></span><br><span class="line"></span><br><span class="line">         Jackson2JsonRedisSerializer&lt;Employee&gt; serializer = <span class="keyword">new</span> Jackson2JsonRedisSerializer&lt;Employee&gt;(Employee.class);</span><br><span class="line"></span><br><span class="line">         template.setDefaultSerializer(serializer);<span class="comment">//设为默认</span></span><br><span class="line"></span><br><span class="line">         <span class="keyword">return</span> template;</span><br><span class="line"></span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     <span class="comment">//只要引入Redis启动器，就会使用Redis作为缓存管理器</span></span><br><span class="line"></span><br><span class="line">     <span class="comment">//springboot通过RedisCacheManager类中的RedisCache来帮我们创建缓存组件，RedisCache通过redis缓存数据的</span></span><br><span class="line"></span><br><span class="line">     <span class="comment">//我们就可以手动修改配置 ，将自定义类型数据的empRedisTemplate放入其使其生效  以json的数据格式存储在Redis缓存中</span></span><br><span class="line"></span><br><span class="line">     <span class="comment">//修改RedisCacheConfiguration类中的RedisCacheManager方法</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// @Primary   默认使用哪个作为缓存管理器</span></span><br><span class="line"></span><br><span class="line">     <span class="meta">@Bean</span></span><br><span class="line"></span><br><span class="line">     <span class="function"><span class="keyword">public</span> RedisCacheManager <span class="title">cacheManager</span><span class="params">(RedisTemplate&lt;Object, Employee&gt; empRedisTemplate)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">         <span class="comment">//将自定义的RedisTemplate放入到缓存管理器中RedisCacheManager</span></span><br><span class="line"></span><br><span class="line">         RedisCacheManager cacheManager = <span class="keyword">new</span> RedisCacheManager(empRedisTemplate);</span><br><span class="line"></span><br><span class="line">         cacheManager.setUsePrefix(<span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">         <span class="keyword">return</span> cacheManager;</span><br><span class="line"></span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;1-springboot默认使用SimpleCacheManager作为缓存管理器，配置文件配置基本的数据源的信息，并开启驼峰命名&quot;&gt;&lt;a href=&quot;#1-springboot默认使用SimpleCacheManager作为缓存管理器，配置文件配置基本的数据源的信息，并开启驼峰命名&quot; class=&quot;headerlink&quot; title=&quot;1.springboot默认使用SimpleCacheManager作为缓存管理器，配置文件配置基本的数据源的信息，并开启驼峰命名&quot;&gt;&lt;/a&gt;1.springboot默认使用SimpleCacheManager作为缓存管理器&lt;/h2&gt;
    
    </summary>
    
    
      <category term="springboot" scheme="http://yoursite.com/tags/springboot/"/>
    
      <category term="cache" scheme="http://yoursite.com/tags/cache/"/>
    
      <category term="redis" scheme="http://yoursite.com/tags/redis/"/>
    
  </entry>
  
  <entry>
    <title>springboot-starter 启动器(五)</title>
    <link href="http://yoursite.com/2019/04/12/springboot-starter/"/>
    <id>http://yoursite.com/2019/04/12/springboot-starter/</id>
    <published>2019-04-12T06:22:45.000Z</published>
    <updated>2019-04-12T06:34:12.323Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-自定义配置springboot的启动器，首先创建一个启动器的maven项目，依赖一个自动配置的maven。然后在自定义的自动配置项目里编写配置文件和配置类"><a href="#1-自定义配置springboot的启动器，首先创建一个启动器的maven项目，依赖一个自动配置的maven。然后在自定义的自动配置项目里编写配置文件和配置类" class="headerlink" title="1.自定义配置springboot的启动器，首先创建一个启动器的maven项目，依赖一个自动配置的maven。然后在自定义的自动配置项目里编写配置文件和配置类"></a>1.自定义配置springboot的启动器<a id="more"></a>，首先创建一个启动器的maven项目，依赖一个自动配置的maven。然后在自定义的自动配置项目里编写配置文件和配置类</h2><p>  启动器的配置文件（pom.xml）</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;</span><br><span class="line"></span><br><span class="line">          xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line"></span><br><span class="line">          xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;</span><br><span class="line"></span><br><span class="line">     &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;</span><br><span class="line"></span><br><span class="line">     &lt;groupId&gt;com.springboot.starter&lt;/groupId&gt;</span><br><span class="line"></span><br><span class="line">     &lt;artifactId&gt;lzg-spring-boot-starter&lt;/artifactId&gt;</span><br><span class="line"></span><br><span class="line">     &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;</span><br><span class="line"></span><br><span class="line">     &lt;!--自定义启动器--&gt;</span><br><span class="line"></span><br><span class="line">     &lt;dependencies&gt;</span><br><span class="line"></span><br><span class="line">         &lt;!--自动配置模块的依赖--&gt;</span><br><span class="line"></span><br><span class="line">         &lt;dependency&gt;</span><br><span class="line"></span><br><span class="line">         &lt;groupId&gt;com.springboot.start.autoconfigurer&lt;/groupId&gt;</span><br><span class="line"></span><br><span class="line">         &lt;artifactId&gt;lzg-spring-boot-start-autoconfigurer&lt;/artifactId&gt;</span><br><span class="line"></span><br><span class="line">         &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;</span><br><span class="line"></span><br><span class="line">         &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">     &lt;/dependencies&gt;</span><br><span class="line"></span><br><span class="line"> &lt;/project&gt;</span><br></pre></td></tr></table></figure><p>  自动配置的配置文件（pom.xml）</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line"></span><br><span class="line">          xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;</span><br><span class="line"></span><br><span class="line">     &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;</span><br><span class="line"></span><br><span class="line">     &lt;parent&gt;</span><br><span class="line"></span><br><span class="line">         &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line"></span><br><span class="line">         &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;</span><br><span class="line"></span><br><span class="line">         &lt;version&gt;1.5.19.RELEASE&lt;/version&gt;</span><br><span class="line"></span><br><span class="line">         &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;</span><br><span class="line"></span><br><span class="line">     &lt;/parent&gt;</span><br><span class="line"></span><br><span class="line">     &lt;groupId&gt;com.springboot.start.autoconfigurer&lt;/groupId&gt;</span><br><span class="line"></span><br><span class="line">     &lt;artifactId&gt;lzg-spring-boot-start-autoconfigurer&lt;/artifactId&gt;</span><br><span class="line"></span><br><span class="line">     &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;</span><br><span class="line"></span><br><span class="line">     &lt;name&gt;lzg-spring-boot-start-autoconfigurer&lt;/name&gt;</span><br><span class="line"></span><br><span class="line">     &lt;description&gt;Demo project for Spring Boot&lt;/description&gt;</span><br><span class="line"></span><br><span class="line">     &lt;properties&gt;</span><br><span class="line"></span><br><span class="line">         &lt;java.version&gt;1.8&lt;/java.version&gt;</span><br><span class="line"></span><br><span class="line">     &lt;/properties&gt;</span><br><span class="line"></span><br><span class="line">     &lt;dependencies&gt;</span><br><span class="line"></span><br><span class="line">         &lt;dependency&gt;</span><br><span class="line"></span><br><span class="line">             &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line"></span><br><span class="line">             &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;</span><br><span class="line"></span><br><span class="line">         &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">     &lt;/dependencies&gt;</span><br><span class="line"></span><br><span class="line"> &lt;/project&gt;</span><br></pre></td></tr></table></figure><h2 id="2-编写自动配置的方法类、属性类和将方法类作为配置的配置类"><a href="#2-编写自动配置的方法类、属性类和将方法类作为配置的配置类" class="headerlink" title="2.编写自动配置的方法类、属性类和将方法类作为配置的配置类"></a>2.编写自动配置的方法类、属性类和将方法类作为配置的配置类</h2><p>  方法业务类需要编写一个业务方法给调用者，在方法体里写好返回的数据，返回的数据中能够获取调用者在application.properties配置文件中配置的属性数据</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">//配置一个前后缀的属性类</span><br><span class="line"></span><br><span class="line"> HelloProperties helloProperties;</span><br><span class="line"></span><br><span class="line"> //提供setter、getter方法</span><br><span class="line"></span><br><span class="line"> public HelloProperties getHelloProperties() &#123;</span><br><span class="line"></span><br><span class="line">     return helloProperties;</span><br><span class="line"></span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> public void setHelloProperties(HelloProperties helloProperties) &#123;</span><br><span class="line"></span><br><span class="line">     this.helloProperties = helloProperties;</span><br><span class="line"></span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> //定义一个方法  等待调用</span><br><span class="line"></span><br><span class="line"> public String sayHello(String name)&#123;</span><br><span class="line"></span><br><span class="line">     //返回数据  其前缀和后缀由我们自动配置好  调用者只需要在配置文件写就可以输出</span><br><span class="line"></span><br><span class="line">     return helloProperties.getPrefix()+&quot;-&quot;+name+&quot;-&quot;+helloProperties.getSuffix();</span><br><span class="line"></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>   我们可以自定义一个能够获取application.properties配置文件中配置的数据的一个属性类，并将属性类中的属性与配置文件中的配置一一映射，获取数据，使用@ConfigurationProperties的注解对其一一映射，可以自定义一个配置文件的前缀名来与之对应  即，prefi=”…”的方式 ， 之后只需要使用@EnableConfigurationProperties指明该配置类是作为配置类即可</p><p>定义一个获取前后缀的属性文件   能够读取到properties配置文件中配置的数据</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">//使用ConfigurationProperties(prefix=&quot;lzg.hello&quot;)  属性前缀为lzg.hello  需要配置哪个属性时即用  lzg.hello.prefix</span><br><span class="line"></span><br><span class="line">@ConfigurationProperties(prefix = &quot;lzg.hello&quot;)</span><br><span class="line"></span><br><span class="line">public class HelloProperties &#123;</span><br><span class="line"></span><br><span class="line">    private String prefix;</span><br><span class="line"></span><br><span class="line">    private  String suffix;</span><br><span class="line"></span><br><span class="line">    public String getPrefix() &#123;</span><br><span class="line"></span><br><span class="line">        return prefix;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setPrefix(String prefix) &#123;</span><br><span class="line"></span><br><span class="line">        this.prefix = prefix;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public String getSuffix() &#123;</span><br><span class="line"></span><br><span class="line">        return suffix;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setSuffix(String suffix) &#123;</span><br><span class="line"></span><br><span class="line">        this.suffix = suffix;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>​    之后再编写一个最重要的springboot配置类，使用@Configuration表明其是一个配置类，使用@Bean注解 将方法业务类添加到容器中，使其生效。并且在该@Configuration表明的配置类中标明能够作为与配置文件一一映射的属性类，使用@EnableConfigurationProperties（属性类.class）即可 ，并在该类中将属性类实例化，依赖注入属性类spring容器进行管理后在属性@ConfigurationProperties注解才能生效。并将该实例化过的属性类交由方法业务类。</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">@Configuration  //将该类作为配置类  使用@Configuration</span><br><span class="line"></span><br><span class="line"> @ConditionalOnWebApplication  //web应用才会生效</span><br><span class="line"></span><br><span class="line"> @EnableConfigurationProperties(HelloProperties.class) //将自定义的属性类添加到配置中才能生效</span><br><span class="line"></span><br><span class="line"> public class HelloAutoConfigurer &#123;</span><br><span class="line"></span><br><span class="line">     //依赖注入HelloProperties  实例化它@ConfigurationProperties(prefix = &quot;lzg.hello&quot;)才会生效</span><br><span class="line"></span><br><span class="line">     @Autowired</span><br><span class="line"></span><br><span class="line">     HelloProperties helloProperties;</span><br><span class="line"></span><br><span class="line">     //将HelloService类添加到容器中 才能生效</span><br><span class="line"></span><br><span class="line">     @Bean</span><br><span class="line"></span><br><span class="line">     public HelloService helloService()&#123;</span><br><span class="line"></span><br><span class="line">         HelloService helloService = new HelloService();</span><br><span class="line"></span><br><span class="line">         //拿到当前实例化的HelloProperties对象  其在配置文件中生效的属性数据已存入helloProperties并交给HelloService类</span><br><span class="line"></span><br><span class="line">         helloService.setHelloProperties(helloProperties);</span><br><span class="line"></span><br><span class="line">         return helloService;</span><br><span class="line"></span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><h2 id="3-之后，springboot规定要在类路径下存在-META-INF-spring-factories文件，在spring-factories文件中配置需要作为自动配置的类。"><a href="#3-之后，springboot规定要在类路径下存在-META-INF-spring-factories文件，在spring-factories文件中配置需要作为自动配置的类。" class="headerlink" title="3.之后，springboot规定要在类路径下存在 /META-INF/spring.factories文件，在spring.factories文件中配置需要作为自动配置的类。"></a>3.之后，springboot规定要在类路径下存在 /META-INF/spring.factories文件，在spring.factories文件中配置需要作为自动配置的类。</h2><p><img src="/2019/04/12/springboot-starter/1.png" alt="img"></p><h2 id="4-最后需要将配置完成的两个Maven项目进行安装才能进行使用。"><a href="#4-最后需要将配置完成的两个Maven项目进行安装才能进行使用。" class="headerlink" title="4.最后需要将配置完成的两个Maven项目进行安装才能进行使用。"></a>4.最后需要将配置完成的两个Maven项目进行安装才能进行使用。</h2><p><img src="/2019/04/12/springboot-starter/2.png" alt="img"></p><h2 id="5-编写一个测试类，该类中需要依赖自定义的启动器即可。"><a href="#5-编写一个测试类，该类中需要依赖自定义的启动器即可。" class="headerlink" title="5.编写一个测试类，该类中需要依赖自定义的启动器即可。"></a>5.编写一个测试类，该类中需要依赖自定义的启动器即可。</h2>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;1-自定义配置springboot的启动器，首先创建一个启动器的maven项目，依赖一个自动配置的maven。然后在自定义的自动配置项目里编写配置文件和配置类&quot;&gt;&lt;a href=&quot;#1-自定义配置springboot的启动器，首先创建一个启动器的maven项目，依赖一个自动配置的maven。然后在自定义的自动配置项目里编写配置文件和配置类&quot; class=&quot;headerlink&quot; title=&quot;1.自定义配置springboot的启动器，首先创建一个启动器的maven项目，依赖一个自动配置的maven。然后在自定义的自动配置项目里编写配置文件和配置类&quot;&gt;&lt;/a&gt;1.自定义配置springboot的启动器&lt;/h2&gt;
    
    </summary>
    
    
      <category term="springboot" scheme="http://yoursite.com/tags/springboot/"/>
    
      <category term="starter" scheme="http://yoursite.com/tags/starter/"/>
    
  </entry>
  
  <entry>
    <title>springboot-data 数据库访问(四)</title>
    <link href="http://yoursite.com/2019/04/12/springboot-data%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BF%E9%97%AE/"/>
    <id>http://yoursite.com/2019/04/12/springboot-data数据库访问/</id>
    <published>2019-04-12T04:41:06.000Z</published>
    <updated>2019-04-12T06:37:19.229Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-springboot对数据库的操作"><a href="#1-springboot对数据库的操作" class="headerlink" title="1.springboot对数据库的操作"></a>1.springboot对数据库的操作<a id="more"></a></h2><p>创建数据库访问的springboot项目需要选择web、jdbc、mysql。如果需要使用mybatis整合则选择mybatis项。</p><p><img src="/2019/04/12/springboot-data数据库访问/1.png" alt></p><h2 id="2-springboot默认加载的数据源是tomcat的数据源"><a href="#2-springboot默认加载的数据源是tomcat的数据源" class="headerlink" title="2.springboot默认加载的数据源是tomcat的数据源"></a>2.springboot默认加载的数据源是tomcat的数据源</h2><p>​    即用org.apache.tomcat.jdbc.pool.DataSource作为数据源；我们可以在properties配置文件中修改 即spring.datasource.type=com.alibaba.druid.pool.DruidDataSource(druid是阿里的数据源)，springboot中的runSchemaScripts()会自动执行建表语句；需要在resources文件夹下放.sql文件，在配置文件中配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">  datasource:</span><br><span class="line">#开启自动建表功能  会加载resource下的.sql文件  1.5.9版本配置就会出错</span><br><span class="line">schema:</span><br><span class="line">  - classpath:department.sql</span><br></pre></td></tr></table></figure><h2 id="3-整合druid数据源。需要先导入druid的依赖，然后在配置文件配置相关的信息。"><a href="#3-整合druid数据源。需要先导入druid的依赖，然后在配置文件配置相关的信息。" class="headerlink" title="3.整合druid数据源。需要先导入druid的依赖，然后在配置文件配置相关的信息。"></a>3.整合druid数据源。需要先导入druid的依赖，然后在配置文件配置相关的信息。</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">  pom文件中的druid的依赖</span><br><span class="line"></span><br><span class="line">&lt;!--引入druid数据源--&gt;</span><br><span class="line"></span><br><span class="line"> &lt;!-- https://mvnrepository.com/artifact/com.alibaba/druid --&gt;</span><br><span class="line"></span><br><span class="line"> &lt;dependency&gt;</span><br><span class="line"></span><br><span class="line">     &lt;groupId&gt;com.alibaba&lt;/groupId&gt;</span><br><span class="line"></span><br><span class="line">     &lt;artifactId&gt;druid&lt;/artifactId&gt;</span><br><span class="line"></span><br><span class="line">     &lt;version&gt;1.1.8&lt;/version&gt;</span><br><span class="line"></span><br><span class="line"> &lt;/dependency&gt;</span><br></pre></td></tr></table></figure><p>配置druid数据源信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">#配置dataSource的相关配置</span><br><span class="line">spring:</span><br><span class="line">  datasource:</span><br><span class="line">    url: jdbc:mysql://127.0.0.1:3306/springboot_data</span><br><span class="line">    username: root</span><br><span class="line">    password: root</span><br><span class="line">    driver-class-name: com.mysql.jdbc.Driver</span><br><span class="line">#springboot默认使用class org.apache.tomcat.jdbc.pool.DataSource的数据源</span><br><span class="line">#使用其他的数据源需要手动配置类型  需要先添加druid的依赖</span><br><span class="line">    type: com.alibaba.druid.pool.DruidDataSource</span><br><span class="line">#配置druid数据源的相关信息</span><br><span class="line">    initialSize: 5</span><br><span class="line">    minIdle: 5</span><br><span class="line">    maxActive: 20</span><br><span class="line">    maxWait: 60000</span><br><span class="line">    timeBetweenEvictionRunsMillis: 60000</span><br><span class="line">    minEvictableIdleTimeMillis: 300000</span><br><span class="line">    validationQuery: SELECT 1 FROM DUAL</span><br><span class="line">    testWhileIdle: true</span><br><span class="line">    testOnBorrow: false</span><br><span class="line">    testOnReturn: false</span><br><span class="line">    poolPreparedStatements: true</span><br><span class="line">    #   配置监控统计拦截的filters，去掉后监控界面sql无法统计，&apos;wall&apos;用于防火墙</span><br><span class="line">    filters: stat,wall,log4j</span><br><span class="line">    maxPoolPreparedStatementPerConnectionSize: 20</span><br><span class="line">    useGlobalDataSourceStat: true</span><br><span class="line">    connectionProperties: druid.stat.mergeSql=true;druid.stat.slowSqlMillis=500</span><br></pre></td></tr></table></figure><h2 id="4-但是，单单这样配置的话，手动配置的druid数据源的相关配置并不会生效，需要我们手动的添加一个DruidDataSource的配置，并需要使用ConfigurationProperties（prefix-”spring-datasource”）将配置文件的属性一一映射-并将其放入容器使它生效。需要注意的是，配置DruidDataSource，需要配置Druid的监控，即需要注册Servlet和Filter。即ServletRegistrationBean并将StatViewServlet放入，FilterRegistrationBean将WebStatFilter设置。"><a href="#4-但是，单单这样配置的话，手动配置的druid数据源的相关配置并不会生效，需要我们手动的添加一个DruidDataSource的配置，并需要使用ConfigurationProperties（prefix-”spring-datasource”）将配置文件的属性一一映射-并将其放入容器使它生效。需要注意的是，配置DruidDataSource，需要配置Druid的监控，即需要注册Servlet和Filter。即ServletRegistrationBean并将StatViewServlet放入，FilterRegistrationBean将WebStatFilter设置。" class="headerlink" title="4.但是，单单这样配置的话，手动配置的druid数据源的相关配置并不会生效，需要我们手动的添加一个DruidDataSource的配置，并需要使用ConfigurationProperties（prefix=”spring.datasource”）将配置文件的属性一一映射    并将其放入容器使它生效。需要注意的是，配置DruidDataSource，需要配置Druid的监控，即需要注册Servlet和Filter。即ServletRegistrationBean并将StatViewServlet放入，FilterRegistrationBean将WebStatFilter设置。"></a>4.但是，单单这样配置的话，手动配置的druid数据源的相关配置并不会生效，需要我们手动的添加一个DruidDataSource的配置，并需要使用ConfigurationProperties（prefix=”spring.datasource”）将配置文件的属性一一映射    并将其放入容器使它生效。需要注意的是，配置DruidDataSource，需要配置Druid的监控，即需要注册Servlet和Filter。即ServletRegistrationBean并将StatViewServlet放入，FilterRegistrationBean将WebStatFilter设置。</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">//导入Druid数据源  并需要手动将DruidDataSource放入容器中</span><br><span class="line"></span><br><span class="line"> @Configuration</span><br><span class="line"></span><br><span class="line"> public class DruidConfig &#123;</span><br><span class="line"></span><br><span class="line">     //将配置文件中的属性进行一一映射</span><br><span class="line"></span><br><span class="line">     @ConfigurationProperties(prefix = &quot;spring.datasource&quot;)</span><br><span class="line"></span><br><span class="line">     @Bean</span><br><span class="line"></span><br><span class="line">     public DataSource druid()&#123;</span><br><span class="line"></span><br><span class="line">         return new DruidDataSource();</span><br><span class="line"></span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     //配置Druid的监控</span><br><span class="line"></span><br><span class="line">     //1、配置一个管理后台的Servlet  注册Servlet组件  需要使用StatViewServlet这个Servlet</span><br><span class="line"></span><br><span class="line">     @Bean</span><br><span class="line"></span><br><span class="line">     public ServletRegistrationBean statViewServlet()&#123;</span><br><span class="line"></span><br><span class="line">         //进入后台路径 http://localhost:8080/druid</span><br><span class="line"></span><br><span class="line">         ServletRegistrationBean stat = new ServletRegistrationBean(new StatViewServlet(),&quot;/druid/*&quot;);</span><br><span class="line"></span><br><span class="line">         HashMap&lt;String, String&gt; map = new HashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">         //到StatViewServlet的父类ResourceServlet中寻找属性并进行设置</span><br><span class="line"></span><br><span class="line">         //后台监控 登入用户账号</span><br><span class="line"></span><br><span class="line">         map.put(&quot;loginUsername&quot;,&quot;admin&quot;);</span><br><span class="line"></span><br><span class="line">         //密码</span><br><span class="line"></span><br><span class="line">         map.put(&quot;loginPassword&quot;,&quot;123456&quot;);</span><br><span class="line"></span><br><span class="line">         map.put(&quot;loginPassword&quot;,&quot;123456&quot;);</span><br><span class="line"></span><br><span class="line">         map.put(&quot;allow&quot;,&quot;&quot;);//默认就是允许所有访问</span><br><span class="line"></span><br><span class="line">         map.put(&quot;deny&quot;,&quot;127.0.0.1&quot;);</span><br><span class="line"></span><br><span class="line">         //将配置进行添加到初始化</span><br><span class="line"></span><br><span class="line">         stat.setInitParameters(map);</span><br><span class="line"></span><br><span class="line">         return  stat;</span><br><span class="line"></span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     //2、配置一个web监控的filter   注册filter组件  使用WebStatFilter</span><br><span class="line"></span><br><span class="line">     @Bean</span><br><span class="line"></span><br><span class="line">     public FilterRegistrationBean webStatFilter()&#123;</span><br><span class="line"></span><br><span class="line">         FilterRegistrationBean bean = new FilterRegistrationBean();</span><br><span class="line"></span><br><span class="line">         bean.setFilter(new WebStatFilter());</span><br><span class="line"></span><br><span class="line">         Map&lt;String,String&gt; map = new HashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">         //排除过滤</span><br><span class="line"></span><br><span class="line">         map.put(&quot;exclusions&quot;,&quot;.js,.css,/druid/*&quot;);</span><br><span class="line"></span><br><span class="line">         bean.setInitParameters(map);</span><br><span class="line"></span><br><span class="line">         //过滤的路径</span><br><span class="line"></span><br><span class="line">         bean.setUrlPatterns(Arrays.asList(&quot;/*&quot;));</span><br><span class="line"></span><br><span class="line">         return bean;</span><br><span class="line"></span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><h2 id="5-整合springboot-mybatis（注解的方式开发）"><a href="#5-整合springboot-mybatis（注解的方式开发）" class="headerlink" title="5.整合springboot+mybatis（注解的方式开发）"></a>5.整合springboot+mybatis（注解的方式开发）</h2><p>映射的接口中的方法：</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">//注解的方式</span><br><span class="line"></span><br><span class="line"> //指定这是一个操作数据库的mapper</span><br><span class="line"></span><br><span class="line"> // 或者在主函数入口设置Mapper的扫描@MapperScan(value=&quot;com.springboot.dao&quot;)</span><br><span class="line"></span><br><span class="line"> //@Mapper</span><br><span class="line"></span><br><span class="line"> public interface DepartmentDao &#123;</span><br><span class="line"></span><br><span class="line">     @Select(&quot;select * from department&quot;)</span><br><span class="line"></span><br><span class="line">     public List&lt;Department&gt; findAll();</span><br><span class="line"></span><br><span class="line">     @Select(&quot;select * from department where id=#&#123;id&#125;&quot;)</span><br><span class="line"></span><br><span class="line">     public Department findById(int id);</span><br><span class="line"></span><br><span class="line">     //添加时设置id为自增主键</span><br><span class="line"></span><br><span class="line">     @Options(useGeneratedKeys = true,keyProperty = &quot;id&quot;)</span><br><span class="line"></span><br><span class="line">     @Insert(&quot;insert into department(departmentName) values(#&#123;departmentName&#125;)&quot;)</span><br><span class="line"></span><br><span class="line">     public void insertOne(Department department);</span><br><span class="line"></span><br><span class="line">     @Delete(&quot;delete from department where id=#&#123;id&#125;&quot;)</span><br><span class="line"></span><br><span class="line">     public void deleteOne(int id);</span><br><span class="line"></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><h2 id="6-整合springboot-mybatis（配置文件的方式开发）"><a href="#6-整合springboot-mybatis（配置文件的方式开发）" class="headerlink" title="6.整合springboot+mybatis（配置文件的方式开发）"></a>6.整合springboot+mybatis（配置文件的方式开发）</h2><p>需要创建全局配置文件mybatis-config.xml和与接口映射的mapper映射配置文件，可以在主配置文件中开启驼峰命名法。并在properties配置文件中指明其位置。如图</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--开启驼峰命名法--&gt;</span><br><span class="line"></span><br><span class="line"> &lt;settings&gt;</span><br><span class="line"></span><br><span class="line">     &lt;setting name=&quot;mapUnderscoreToCamelCase&quot; value=&quot;true&quot;/&gt;</span><br><span class="line"></span><br><span class="line"> &lt;/settings&gt;</span><br></pre></td></tr></table></figure><p><img src="/2019/04/12/springboot-data数据库访问/2.png" alt="img"></p><h2 id="7-整合springdata-jpa"><a href="#7-整合springdata-jpa" class="headerlink" title="7.整合springdata jpa"></a>7.整合springdata jpa</h2><p>​    1）、编写一个实体类（bean）和数据表进行映射，并且配置好映射关系；</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">//使用JPA注解配置映射关系</span><br><span class="line"></span><br><span class="line">@Entity //告诉JPA这是一个实体类（和数据表映射的类）</span><br><span class="line"></span><br><span class="line">@Table(name = &quot;tbl_user&quot;) //@Table来指定和哪个数据表对应;如果省略默认表名就是user；</span><br><span class="line"></span><br><span class="line">public class User &#123;</span><br><span class="line"></span><br><span class="line">@Id //这是一个主键</span><br><span class="line"></span><br><span class="line">@GeneratedValue(strategy = GenerationType.IDENTITY)//自增主键</span><br><span class="line"></span><br><span class="line">private Integer id;</span><br><span class="line"></span><br><span class="line">@Column(name = &quot;last_name&quot;,length = 50) //这是和数据表对应的一个列</span><br><span class="line"></span><br><span class="line">private String lastName;</span><br><span class="line"></span><br><span class="line">@Column //省略默认列名就是属性名</span><br><span class="line"></span><br><span class="line">private String email;</span><br></pre></td></tr></table></figure><p>   2）、编写一个Dao接口来操作实体类对应的数据表（Repository）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">   //继承JpaRepository来完成对数据库的操作</span><br><span class="line"></span><br><span class="line">   public interface UserRepository extends JpaRepository&lt;User,Integer&gt; &#123;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   3）、基本的配置JpaProperties</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">  spring:  </span><br><span class="line"></span><br><span class="line">     jpa:</span><br><span class="line"></span><br><span class="line">        hibernate:</span><br><span class="line"></span><br><span class="line">#     更新或者创建数据表结构</span><br><span class="line"></span><br><span class="line">           ddl-auto: update</span><br><span class="line"></span><br><span class="line">#    控制台显示SQL</span><br><span class="line"></span><br><span class="line">       show-sql: true</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;1-springboot对数据库的操作&quot;&gt;&lt;a href=&quot;#1-springboot对数据库的操作&quot; class=&quot;headerlink&quot; title=&quot;1.springboot对数据库的操作&quot;&gt;&lt;/a&gt;1.springboot对数据库的操作&lt;/h2&gt;
    
    </summary>
    
    
      <category term="springboot" scheme="http://yoursite.com/tags/springboot/"/>
    
      <category term="mysql" scheme="http://yoursite.com/tags/mysql/"/>
    
      <category term="jdbc" scheme="http://yoursite.com/tags/jdbc/"/>
    
      <category term="mybatis" scheme="http://yoursite.com/tags/mybatis/"/>
    
  </entry>
  
  <entry>
    <title>springboot 错误信息定制(三)</title>
    <link href="http://yoursite.com/2019/04/12/springboot%E9%94%99%E8%AF%AF%E4%BF%A1%E6%81%AF%E5%AE%9A%E5%88%B6/"/>
    <id>http://yoursite.com/2019/04/12/springboot错误信息定制/</id>
    <published>2019-04-12T04:03:54.000Z</published>
    <updated>2019-04-12T06:37:52.024Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-错误信息"><a href="#1-错误信息" class="headerlink" title="1. 错误信息"></a>1. 错误信息<a id="more"></a></h2><p>当由springboot启动的服务出现错误时，在有thymeleaf模板引擎的情况下时springboot会自动寻找templates文件夹下是否存在error文件夹，error文件夹下是否存在出错的状态码.html。在没有模板的情况下自动寻找静态资源文件件下的error/状态码.html。</p><p>即，我们可以自定义错误页面，有模板情况下，在templates下创建，error/4xx.html或者5xx.html。以四开头或五开头的错误都会在这寻找，或者也可以定义具体的错误页面如：404.html等。</p><p>​     发生此状态码的错误就会来到 对应的页面；精确优先（优先寻找精确的状态码.html）； </p><p>​     页面能获取的信息:</p><ul><li>timestamp：时间戳</li><li>status：状态码</li><li>error：错误提示</li><li>exception：异常对象</li><li>message：异常消息</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;h1&gt;timestamp:[[$&#123;#dates.format(timestamp,&apos;yyyy-MM-dd HH:mm:ss&apos;)&#125;]]&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line">&lt;h1&gt;status:[[$&#123;status&#125;]]&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line">&lt;h1&gt;error:[[$&#123;error&#125;]]&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line">&lt;h1&gt;message:[[$&#123;message&#125;]]&lt;/h1&gt;</span><br></pre></td></tr></table></figure><h2 id="2-自定义异常的处理-amp-自定义输出错误信息"><a href="#2-自定义异常的处理-amp-自定义输出错误信息" class="headerlink" title="2.自定义异常的处理&amp;自定义输出错误信息"></a>2.自定义异常的处理&amp;自定义输出错误信息</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">//自定义异常信息</span><br><span class="line"></span><br><span class="line"> @ControllerAdvice</span><br><span class="line"></span><br><span class="line"> public class MyExceptionHandler &#123;</span><br><span class="line"></span><br><span class="line">     @ExceptionHandler(MyException.class)</span><br><span class="line"></span><br><span class="line">     public  String handler(Exception e,HttpServletRequest request)&#123;</span><br><span class="line"></span><br><span class="line">         HashMap&lt;String, Object&gt; map = new HashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">         //浏览器页面获取错误信息时   传入我们自己的错误状态码  4xx 5xx，否则就不会进入定制错误页面的解析流程</span><br><span class="line"></span><br><span class="line">         /*          * Integer statusCode = (Integer) request          .getAttribute(&quot;javax.servlet.error.status_code&quot;);          /                                                 //     状态码</span><br><span class="line"></span><br><span class="line">         request.setAttribute(&quot;javax.servlet.error.status_code&quot;,500);</span><br><span class="line"></span><br><span class="line">         map.put(&quot;error&quot;,&quot;用户异常&quot;);</span><br><span class="line"></span><br><span class="line">         map.put(&quot;message&quot;,e.getMessage());</span><br><span class="line"></span><br><span class="line">         //将集合map放入Reqeust域中   等待DefaultErrorAttributes的子类获取</span><br><span class="line"></span><br><span class="line">         request.setAttribute(&quot;ext&quot;,map);</span><br><span class="line"></span><br><span class="line">         //转发到error下进行解析</span><br><span class="line"></span><br><span class="line">         return  &quot;forward:/error&quot;;</span><br><span class="line"></span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p>并需要将该map集合中的数据放入到springboot加载错误页面的容器中DefaultErrorAttributes.getErrorAttributes()；默认进行数据处理的；</p><p>所有的数据都是通过errorAttributes.getErrorAttributes得到；所以可以往DefaultErrorAttributes.getErrorAttributes()中添加自定义的错误数据信息</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">/实例化添加到容器中</span><br><span class="line"></span><br><span class="line"> @Component</span><br><span class="line"></span><br><span class="line"> public class MyDefaultErrorAttributes extends DefaultErrorAttributes &#123;</span><br><span class="line"></span><br><span class="line">     @Override</span><br><span class="line"></span><br><span class="line">     //将自定义设置的内容添加到DefaultErrorAttributes中后 可以获取得到</span><br><span class="line"></span><br><span class="line">     public Map&lt;String, Object&gt; getErrorAttributes(RequestAttributes requestAttributes, boolean includeStackTrace) &#123;</span><br><span class="line"></span><br><span class="line">         Map&lt;String, Object&gt; map = super.getErrorAttributes(requestAttributes, includeStackTrace);</span><br><span class="line"></span><br><span class="line">         //第二个参数为 域  0为request域  1为session域</span><br><span class="line"></span><br><span class="line">         Object ext = requestAttributes.getAttribute(&quot;ext&quot;,0);</span><br><span class="line"></span><br><span class="line">         //将获得的内容放入DefaultErrorAttributes中生效</span><br><span class="line"></span><br><span class="line">         map.put(&quot;ext&quot;,ext);</span><br><span class="line"></span><br><span class="line">         map.put(&quot;person&quot;,&quot;lzg&quot;);</span><br><span class="line"></span><br><span class="line">         return map;</span><br><span class="line"></span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure><p>页面就可以获得</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;h1&gt;timestamp:[[$&#123;#dates.format(timestamp,&apos;yyyy-MM-dd HH:mm:ss&apos;)&#125;]]&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line"> &lt;h1&gt;status:[[$&#123;status&#125;]]&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line"> &lt;h1&gt;error:[[$&#123;error&#125;]]&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line"> &lt;h1&gt;message:[[$&#123;message&#125;]]&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line"> &lt;h1&gt;person:[[$&#123;person&#125;]]&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line"> &lt;!--获取自定义扩展的内容--&gt;</span><br><span class="line"></span><br><span class="line"> &lt;h1&gt;ext:[[$&#123;ext.error&#125;]]&lt;/h1&gt;</span><br><span class="line"></span><br><span class="line"> &lt;h1&gt;ext:[[$&#123;ext.message&#125;]]&lt;/h1&gt;</span><br></pre></td></tr></table></figure><h2 id="3-springboot的Servlet容器的配置"><a href="#3-springboot的Servlet容器的配置" class="headerlink" title="3.springboot的Servlet容器的配置"></a>3.springboot的Servlet容器的配置</h2><p>springoot的配置信息可以在properties文件中进行配置，或者用代码的方式实现配置，需要编写一个EmbeddedServletContainerCustomizer类 ，并将其放入到容器中，才能生效。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">//自定义设置Servlet容器的配置信息</span><br><span class="line"></span><br><span class="line"> @Configuration</span><br><span class="line"></span><br><span class="line"> public class MyServletConfigurer &#123;</span><br><span class="line"></span><br><span class="line">     //编写一个EmbeddedServletContainerCustomizer：嵌入式的Servlet容器的定制器；来修改Servlet容器的配置</span><br><span class="line"></span><br><span class="line">     //放入到容器中</span><br><span class="line"></span><br><span class="line">     @Bean</span><br><span class="line"></span><br><span class="line">     public EmbeddedServletContainerCustomizer embeddedServletContainerCustomizer()&#123;</span><br><span class="line"></span><br><span class="line">         //定制嵌入式容器的相关规则</span><br><span class="line"></span><br><span class="line">         return new EmbeddedServletContainerCustomizer() &#123;</span><br><span class="line"></span><br><span class="line">             @Override</span><br><span class="line"></span><br><span class="line">             public void customize(ConfigurableEmbeddedServletContainer container) &#123;</span><br><span class="line"></span><br><span class="line">                 //设置tomcat端口  相当properties文件中的 server.port=8081</span><br><span class="line"></span><br><span class="line">                 container.setPort(8081);</span><br><span class="line"></span><br><span class="line">                 //设置路径      相当properties文件中的 server.context-path=/servlet</span><br><span class="line"></span><br><span class="line">                 //container.setContextPath(&quot;/servlet&quot;);</span><br><span class="line"></span><br><span class="line">             &#125;</span><br><span class="line"></span><br><span class="line">         &#125;;</span><br><span class="line"></span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure><h2 id="4-注册Servlet的三大组件"><a href="#4-注册Servlet的三大组件" class="headerlink" title="4.注册Servlet的三大组件"></a>4.注册Servlet的三大组件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">//注册三大组件</span><br><span class="line"></span><br><span class="line"> @Bean</span><br><span class="line"></span><br><span class="line"> public ServletRegistrationBean myServlet()&#123;</span><br><span class="line"></span><br><span class="line">     ServletRegistrationBean registrationBean = new ServletRegistrationBean(new MyServlet(),&quot;/myServlet&quot;);</span><br><span class="line"></span><br><span class="line">     return registrationBean;</span><br><span class="line"></span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> @Bean</span><br><span class="line"></span><br><span class="line"> public FilterRegistrationBean myFilter()&#123;</span><br><span class="line"></span><br><span class="line">     FilterRegistrationBean filterRegistrationBean = new FilterRegistrationBean();</span><br><span class="line"></span><br><span class="line">     filterRegistrationBean.setFilter(new MyFilter());</span><br><span class="line"></span><br><span class="line">     filterRegistrationBean.setUrlPatterns(Arrays.asList(&quot;/hello&quot;,&quot;/myServlet&quot;));</span><br><span class="line"></span><br><span class="line">     return filterRegistrationBean;</span><br><span class="line"></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;1-错误信息&quot;&gt;&lt;a href=&quot;#1-错误信息&quot; class=&quot;headerlink&quot; title=&quot;1. 错误信息&quot;&gt;&lt;/a&gt;1. 错误信息&lt;/h2&gt;
    
    </summary>
    
    
      <category term="springboot" scheme="http://yoursite.com/tags/springboot/"/>
    
      <category term="exception" scheme="http://yoursite.com/tags/exception/"/>
    
      <category term="servlet" scheme="http://yoursite.com/tags/servlet/"/>
    
  </entry>
  
  <entry>
    <title>springboot-web(二)</title>
    <link href="http://yoursite.com/2019/04/12/springboot-web/"/>
    <id>http://yoursite.com/2019/04/12/springboot-web/</id>
    <published>2019-04-12T03:17:20.000Z</published>
    <updated>2019-04-12T06:52:59.486Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-springboot-web访问"><a href="#1-springboot-web访问" class="headerlink" title="1.springboot-web访问"></a>1.springboot-web访问<a id="more"></a></h2><p>springboot需要手动引入jquery的webjars包，pom文件的依赖为</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line"></span><br><span class="line">      &lt;groupId&gt;org.webjars&lt;/groupId&gt;</span><br><span class="line"></span><br><span class="line">      &lt;artifactId&gt;jquery&lt;/artifactId&gt;</span><br><span class="line"></span><br><span class="line">      &lt;version&gt;3.3.1&lt;/version&gt;</span><br><span class="line"></span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><p>springboot的web服务中，需要把静态资源，如html、css、js等资源放在resources的public或static文件夹中，springboot默认进入静态文件夹中寻找。</p><h2 id="2-springboot使用thymeleaf模板"><a href="#2-springboot使用thymeleaf模板" class="headerlink" title="2.springboot使用thymeleaf模板"></a>2.springboot使用thymeleaf模板</h2><p>使用thymeleaf模板需要引入模板依赖并配置属性版本，此时@RequestMapping注解下的返回就是跳转的页面，thymeleaf自动配置了其页面需要放在templates文件下，并以html为后缀。html页面能对返回的数据进行接收并处理</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--引入thymeleaf模板 --&gt;</span><br><span class="line"></span><br><span class="line"> &lt;dependency&gt;</span><br><span class="line"></span><br><span class="line">     &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line"></span><br><span class="line">     &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;</span><br><span class="line"></span><br><span class="line"> &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;properties&gt;</span><br><span class="line"></span><br><span class="line">     &lt;java.version&gt;1.8&lt;/java.version&gt;</span><br><span class="line"></span><br><span class="line">     &lt;!--设置thymeleaf版本--&gt;</span><br><span class="line"></span><br><span class="line">     &lt;thymeleaf.version&gt;3.0.9.RELEASE&lt;/thymeleaf.version&gt;</span><br><span class="line"></span><br><span class="line">     &lt;!-- 布局功能的支持程序  thymeleaf3主程序  layout2以上版本 --&gt;</span><br><span class="line"></span><br><span class="line">     &lt;!-- thymeleaf2   layout1--&gt;</span><br><span class="line"></span><br><span class="line">     &lt;thymeleaf-layout-dialect.version&gt;2.2.2&lt;/thymeleaf-layout-dialect.version&gt;</span><br><span class="line"></span><br><span class="line"> &lt;/properties&gt;</span><br></pre></td></tr></table></figure><p>springboot配置页面的title图标：需要把命名为favicon.ico的图放在静态资源中，即static或public文件夹中。</p><p>注：配置html页面的中加  </p><p>注明使用thymeleaf模板，之后会有代码提示</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;html lang=<span class="string">"en"</span> xmlns:th=<span class="string">"http://www.thymeleaf.org"</span>&gt;</span><br></pre></td></tr></table></figure><p>在head标签中添加（当favicon.ico文件在static下时）：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;link rel=&quot;shortcut icon&quot; th:href=&quot;@&#123;/static/favicon.ico&#125;&quot;/&gt;</span><br><span class="line"></span><br><span class="line">&lt;link rel=&quot;bookmark&quot; th:href=&quot;@&#123;/static/favicon.ico&#125;&quot;/&gt;</span><br></pre></td></tr></table></figure><h2 id="3-thymeleaf模板引擎的基本语法"><a href="#3-thymeleaf模板引擎的基本语法" class="headerlink" title="3.thymeleaf模板引擎的基本语法"></a>3.thymeleaf模板引擎的基本语法</h2><ul><li>${}:获取值</li><li>@{}：定义url</li><li>#{}：获取国际化内容</li><li>~{}：片段引用表达</li></ul><p>常用：</p><p>​    th:text  :文本</p><blockquote><p>th:text == [[]]:th：text 输出值，只能在标签中使用   [[]]可以不在标签中用 </p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;div th:text=&quot;$&#123;hello&#125;&quot;&gt;&lt;/div&gt; ===&lt;div&gt;[[$&#123;hello&#125;]]&lt;/div&gt;</span><br></pre></td></tr></table></figure><p>​    th:each :遍历</p><blockquote><p>th:each=”l:${list}”  遍历list并以 l 作为引用</p></blockquote><blockquote><p>th:each=”l:${list[1]}” 获取list集合中的第二位</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;div th:text=&quot;$&#123;l&#125;&quot; th:each=&quot;l:$&#123;list&#125;&quot;&gt;&lt;/div&gt;</span><br></pre></td></tr></table></figure><h2 id="4-springboot扩展springmvc的功能"><a href="#4-springboot扩展springmvc的功能" class="headerlink" title="4.springboot扩展springmvc的功能"></a>4.springboot扩展springmvc的功能</h2><p>需要重写springboot中的WebMvcConfigurerAdapter类的方法，或者自定义spring的配置并将对象放入容器中</p> <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> WebMvcConfigurerAdapter <span class="title">webMvcConfigurerAdapter</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        WebMvcConfigurerAdapter adapter = <span class="keyword">new</span> WebMvcConfigurerAdapter() &#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//注册拦截器</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">/*@Override</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">            public void addInterceptors(InterceptorRegistry registry) &#123;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">                //super.addInterceptors(registry);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">                //注册拦截器  添加需要拦截的路径"/**"拦截所有目录  排除（excludePathPatterns）一些路径</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">                registry.addInterceptor(new LoginInterceptor()).addPathPatterns("/**")</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">                        .excludePathPatterns("/","/index.html","/login");</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">            &#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line"></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addViewControllers</span><span class="params">(ViewControllerRegistry registry)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">                <span class="comment">//super.addViewControllers(registry);</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">//前端页面跳转页面会进这里</span></span><br><span class="line"></span><br><span class="line">                registry.addViewController(<span class="string">"/"</span>).setViewName(<span class="string">"login"</span>);</span><br><span class="line"></span><br><span class="line">                registry.addViewController(<span class="string">"/index.html"</span>).setViewName(<span class="string">"login"</span>);</span><br><span class="line"></span><br><span class="line">                registry.addViewController(<span class="string">"/main.html"</span>).setViewName(<span class="string">"dashboard"</span>);</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> adapter;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="5-关闭thymeleaf模板引擎的缓存功能"><a href="#5-关闭thymeleaf模板引擎的缓存功能" class="headerlink" title="5.关闭thymeleaf模板引擎的缓存功能"></a>5.关闭thymeleaf模板引擎的缓存功能</h2><p>在properties配置文件中配置关闭thymeleaf模板引擎的缓存功能，只要在HTML页面按ctrl+F9就可以重新build一下，不需要重启。</p><p>关闭缓存 修改完html后一定要ctrl+f9重新build一下</p><blockquote><p>spring.thymeleaf.cache=<strong>false</strong> </p></blockquote><h2 id="6-使用thymeleaf模板引擎抽取公共片段"><a href="#6-使用thymeleaf模板引擎抽取公共片段" class="headerlink" title="6.使用thymeleaf模板引擎抽取公共片段"></a>6.使用thymeleaf模板引擎抽取公共片段</h2><p>使用thymeleaf模板引擎抽取公共片段，使多页面之间保持一致的内容。在母版页面如mother.html中配置</p><blockquote><p>th：fragment=”top”;</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 使用thymeleaf公共页面元素抽取： th:fragment=&quot;top&quot;--&gt;</span><br><span class="line"></span><br><span class="line">&lt;nav class=&quot;navbar navbar-dark sticky-top bg-dark flex-md-nowrap p-0&quot; th:fragment=&quot;top&quot;&gt;</span><br></pre></td></tr></table></figure><p>判断信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;a class=&quot;nav-link&quot; href=&quot;#&quot; th:href=&quot;@&#123;/findCustList&#125;&quot;</span><br><span class="line"></span><br><span class="line">    th:class=&quot;$&#123;activeUri==&apos;cust&apos;?&apos;nav-link active&apos;:&apos;nav-link&apos;&#125;&quot;&gt;</span><br></pre></td></tr></table></figure><p>在其要引用的chil.html中配置th：insert=”mother::top” 或者 th：replace=”mother::top”;即可引用top部分。</p> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 使用thymeleaf公共页面元素抽取： th:fragment=&quot;top&quot;--&gt;</span><br><span class="line"></span><br><span class="line"> &lt;div th:replace=&quot;dashboard::top&quot;&gt;&lt;/div&gt;</span><br></pre></td></tr></table></figure><p>或者：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> &lt;div th:replace=&quot;dashboard::side(activeUri=&apos;cust&apos;)&quot;&gt;&lt;/div&gt; </span><br><span class="line">//(activeUri=&apos;cust&apos;)为判断所带的信息</span><br></pre></td></tr></table></figure><h2 id="7-thymeleaf模板引擎的一些使用方法"><a href="#7-thymeleaf模板引擎的一些使用方法" class="headerlink" title="7.thymeleaf模板引擎的一些使用方法"></a>7.thymeleaf模板引擎的一些使用方法</h2><p>每个需要使用th的页面都需要引入标签，之后页面就会有th的提示信息：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;html lang=&quot;en&quot; xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;</span><br></pre></td></tr></table></figure><p>获取时间信息以一定的格式输出到页面：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input th:value=&quot;$&#123;#dates.format(emp.birth,&apos;yyyy-MM-dd HH:mm&apos;)&#125;&quot;&gt;</span><br></pre></td></tr></table></figure><p>判断某一个是否符合再进行输出信息：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;p style=&quot;color: red&quot; th:text=&quot;$&#123;msg&#125;&quot; th:if=&quot;$&#123;not #strings.isEmpty(msg)&#125;&quot;&gt;&lt;/p&gt;</span><br></pre></td></tr></table></figure><p>以restfull的形式传递数据:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"btn btn-sm btn-primary"</span> <span class="attr">th:href</span>=<span class="string">"@&#123;/emp/&#125;+$&#123;emp.id&#125;"</span>&gt;</span>编辑<span class="tag">&lt;/<span class="name">a</span>&gt;</span>  //即：@&#123;/emp/&#123;id&#125;&#125;</span><br></pre></td></tr></table></figure><font size="5">springboot可以在properties文件中设置提交的日期数据格式</font><p>定义日期存储格式</p><blockquote><p>spring.mvc.date-format=yyyy-MM-dd</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;1-springboot-web访问&quot;&gt;&lt;a href=&quot;#1-springboot-web访问&quot; class=&quot;headerlink&quot; title=&quot;1.springboot-web访问&quot;&gt;&lt;/a&gt;1.springboot-web访问&lt;/h2&gt;
    
    </summary>
    
    
      <category term="springboot" scheme="http://yoursite.com/tags/springboot/"/>
    
      <category term="thymeleaf" scheme="http://yoursite.com/tags/thymeleaf/"/>
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>springboot 入门(一)</title>
    <link href="http://yoursite.com/2019/04/12/springboot%E5%85%A5%E9%97%A8/"/>
    <id>http://yoursite.com/2019/04/12/springboot入门/</id>
    <published>2019-04-12T02:38:32.000Z</published>
    <updated>2019-04-12T09:20:37.286Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-springboot注解开发"><a href="#1-springboot注解开发" class="headerlink" title="1.springboot注解开发"></a>1.springboot注解开发<a id="more"></a></h2><font size="4"><strong>@SpringBootApplication</strong>  :配置springboot的启动主函数SpringApplication.run(当前类.class,args)  :启动springboot<br><br><strong>@RestCotroller</strong>  :@Response和@Controller的结合  实例化对象并返回值<br><br><strong>@RequestMapping(“/hello”)</strong>  :springmvc的注解 映射客户端的访问路径2.springboot的配置文件application.properties和application.yaml文件<br><br>注解：<br><br><strong>@Component</strong>   :将当前类交由spring容器管理并实例化<br><br><strong>@ConfigurationProperties(prefix=”person”)</strong>    ：映射配置文件中的person中的值到当前类中  需要先将类交由容器管理次注解才有效<br><br><strong>@ImportResource(location=”classpath:applicationContext.xml”)</strong>  :在主函数的类上配置  主要是将spring配置文件中的配置在springboot中生效<br><br><strong>@PropertySource(“指定的属性文件”)</strong>   ：自定义springboot中的属性文件的映射<br><br><strong>@Configuration  @Bean</strong>   :自定义spring配置文件   并将创建的对象放入容器中  id为该类的方法名</font><h2 id="2-application-yml的语法"><a href="#2-application-yml的语法" class="headerlink" title="2.application.yml的语法"></a>2.application.yml的语法</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">server:</span><br><span class="line"></span><br><span class="line">     port: 8080   #配置服务端口</span><br><span class="line"></span><br><span class="line">     context-path:/demo  #配置访问路径  如果mapping上写的是/hello，即访问地址为http://                                      localhost：8080/demo/hello</span><br><span class="line"></span><br><span class="line"> spring:</span><br><span class="line"></span><br><span class="line">     profile:</span><br><span class="line"></span><br><span class="line">   active: demo   #配置加载demo</span><br><span class="line"></span><br><span class="line"> person：    #配置javabean中的属性的值    list集合和map集合需要在bean中写上泛型</span><br><span class="line"></span><br><span class="line">     name: lili</span><br><span class="line"></span><br><span class="line">     age: 18</span><br><span class="line"></span><br><span class="line">     list:</span><br><span class="line"></span><br><span class="line">    -a</span><br><span class="line"></span><br><span class="line">    -b</span><br><span class="line"></span><br><span class="line">     map:</span><br><span class="line"></span><br><span class="line">   k1: 1</span><br><span class="line"></span><br><span class="line">   k2: 2</span><br></pre></td></tr></table></figure><h2 id="3-springboot的日志"><a href="#3-springboot的日志" class="headerlink" title="3.springboot的日志"></a>3.springboot的日志</h2><p>springboot默认使用slf4j和logback作为日志的配置，配置属性需要在application.properties文件中设置</p><p>日志的输出打印级别从低到高： trace&lt;debug&lt;info&lt;warn&lt;error</p><p>logging.level.com.springboot=trace   :设置com.springboot包下的打印trace级别以上的日志信息</p><p>logging.path=D:/IDEA/springlogging   :自定义设置日志打印的位置  默认在控制台打印  并默认以spring.log的                文件存储在文件夹下</p><p>logging.file=D:/IDEA/springboot.log  :自定义日志的存储位置和文件名</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;1-springboot注解开发&quot;&gt;&lt;a href=&quot;#1-springboot注解开发&quot; class=&quot;headerlink&quot; title=&quot;1.springboot注解开发&quot;&gt;&lt;/a&gt;1.springboot注解开发&lt;/h2&gt;
    
    </summary>
    
    
      <category term="springboot" scheme="http://yoursite.com/tags/springboot/"/>
    
      <category term="logging" scheme="http://yoursite.com/tags/logging/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="http://yoursite.com/2019/03/31/hello-world/"/>
    <id>http://yoursite.com/2019/03/31/hello-world/</id>
    <published>2019-03-31T04:54:41.100Z</published>
    <updated>2019-03-31T12:24:52.499Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info.<a id="more"></a> If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>. </p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.io/docs/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;documentation&lt;/a&gt; for more info.&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
</feed>
